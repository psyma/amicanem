/*! For license information please see app.8ef9492a.js.LICENSE.txt */
(self.webpackChunk=self.webpackChunk||[]).push([[524],{5926:(e,t,r)=>{var n={"./hello_controller.js":6824,"./main_controller.js":6597,"./registration_controller.js":27,"./resetpassword_controller.js":4378,"./security_controller.js":2401,"./two_factor_auth_controller.js":945};function a(e){var t=o(e);return r(t)}function o(e){if(!r.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}a.keys=function(){return Object.keys(n)},a.resolve=o,e.exports=a,a.id=5926},5828:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(2891);const a={"symfony--ux-turbo--turbo-core":class extends n.xI{constructor(e){super(e),this.__stimulusLazyController=!0}initialize(){this.application.controllers.find((e=>e.identifier===this.identifier&&e.__stimulusLazyController))||Promise.all([r.e(89),r.e(797)]).then(r.bind(r,8797)).then((e=>{this.application.register(this.identifier,e.default)}))}}}},6824:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>l});r(2675),r(9463),r(2259),r(5700),r(6280),r(6918),r(3792),r(9572),r(4170),r(2892),r(9904),r(4185),r(875),r(287),r(6099),r(825),r(7764),r(2953);function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,o(n.key),n)}}function o(e){var t=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=n(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==n(t)?t:t+""}function i(e,t,r){return t=c(t),function(e,t){if(t&&("object"==n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,s()?Reflect.construct(t,r||[],c(e).constructor):t.apply(e,r))}function s(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(s=function(){return!!e})()}function c(e){return c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},c(e)}function u(e,t){return u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},u(e,t)}var l=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(t,e),r=t,(n=[{key:"connect",value:function(){console.log("Hello World!")}}])&&a(r.prototype,n),o&&a(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(r(2891).xI)},6597:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>He});r(2675),r(9463),r(6412),r(2259),r(5700),r(8125),r(6280),r(6918),r(8706),r(1629),r(3792),r(4114),r(4490),r(4782),r(4743),r(1745),r(8309),r(739),r(9572),r(3288),r(4170),r(2010),r(3110),r(4731),r(6033),r(479),r(2892),r(9904),r(4185),r(875),r(9432),r(287),r(6099),r(8940),r(3362),r(825),r(7495),r(8781),r(7764),r(1489),r(8140),r(1630),r(2170),r(5044),r(1920),r(1694),r(9955),r(1903),r(1134),r(3206),r(4496),r(6651),r(2887),r(9369),r(6812),r(8995),r(1575),r(6072),r(8747),r(8845),r(9423),r(7301),r(373),r(6614),r(1405),r(3684),r(3250),r(149),r(4082),r(2945),r(3500),r(2953),r(5815),r(4979),r(9739),r(6031),r(3296),r(7208),r(8408);var n=r(2891);r(4346),r(906),r(3418),r(2062),r(2712),r(6910),r(4554),r(9089),r(2637),r(1761),r(8156),r(2207);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,s(n.key),n)}}function i(e,t,r){return(t=s(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(e){var t=function(e,t){if("object"!=a(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==a(t)?t:t+""}var c=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)},r=[{key:"TEXT",get:function(){return TEXT}},{key:"IMAGE",get:function(){return IMAGE}},{key:"GIF",get:function(){return GIF}}],(t=null)&&o(e.prototype,t),r&&o(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}();i(c,"TEXT",0),i(c,"IMAGE",1),i(c,"GIF",2),i(c,"AUDIO",3);var u,l=r(6880),d=r.n(l),f=r(9949),p=r(2315);function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o,i,s=[],c=!0,u=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){u=!0,a=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw a}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return m(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?m(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function g(){g=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,a=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var o=t&&t.prototype instanceof y?t:y,i=Object.create(o.prototype),s=new j(n||[]);return a(i,"_invoke",{value:I(e,r,s)}),i}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var f="suspendedStart",p="suspendedYield",h="executing",m="completed",v={};function y(){}function w(){}function x(){}var E={};u(E,i,(function(){return this}));var L=Object.getPrototypeOf,k=L&&L(L(P([])));k&&k!==r&&n.call(k,i)&&(E=k);var M=x.prototype=y.prototype=Object.create(E);function C(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function A(e,t){function r(a,o,i,s){var c=d(e[a],e,o);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==b(l)&&n.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,i,s)}),(function(e){r("throw",e,i,s)})):t.resolve(l).then((function(e){u.value=e,i(u)}),(function(e){return r("throw",e,i,s)}))}s(c.arg)}var o;a(this,"_invoke",{value:function(e,n){function a(){return new t((function(t,a){r(e,n,t,a)}))}return o=o?o.then(a,a):a()}})}function I(t,r,n){var a=f;return function(o,i){if(a===h)throw Error("Generator is already running");if(a===m){if("throw"===o)throw i;return{value:e,done:!0}}for(n.method=o,n.arg=i;;){var s=n.delegate;if(s){var c=T(s,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===f)throw a=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=h;var u=d(t,r,n);if("normal"===u.type){if(a=n.done?m:p,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(a=m,n.method="throw",n.arg=u.arg)}}}function T(t,r){var n=r.method,a=t.iterator[n];if(a===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,T(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var o=d(a,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,v;var i=o.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,v):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function j(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function P(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,o=function r(){for(;++a<t.length;)if(n.call(t,a))return r.value=t[a],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(b(t)+" is not iterable")}return w.prototype=x,a(M,"constructor",{value:x,configurable:!0}),a(x,"constructor",{value:w,configurable:!0}),w.displayName=u(x,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,x):(e.__proto__=x,u(e,c,"GeneratorFunction")),e.prototype=Object.create(M),e},t.awrap=function(e){return{__await:e}},C(A.prototype),u(A.prototype,s,(function(){return this})),t.AsyncIterator=A,t.async=function(e,r,n,a,o){void 0===o&&(o=Promise);var i=new A(l(e,r,n,a),o);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},C(M),u(M,c,"Generator"),u(M,i,(function(){return this})),u(M,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=P,j.prototype={constructor:j,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function a(n,a){return s.type="throw",s.arg=t,r.next=n,a&&(r.method="next",r.arg=e),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],s=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;O(r)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:P(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),v}},t}function v(e,t,r,n,a,o,i){try{var s=e[o](i),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,a)}function y(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){v(o,n,a,i,s,"next",e)}function s(e){v(o,n,a,i,s,"throw",e)}i(void 0)}))}}function b(e){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(e)}function w(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,L(n.key),n)}}function x(e,t,r){return t&&w(e.prototype,t),r&&w(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function E(e,t,r){return(t=L(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function L(e){var t=function(e,t){if("object"!=b(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=b(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==b(t)?t:t+""}var k=x((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}));u=k,E(k,"encryptMessage",function(){var e=y(g().mark((function e(t,r){var n,a,o,i,s,c,l,d,f,p,h=arguments;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=h.length>2&&void 0!==h[2]?h[2]:190,e.next=3,window.crypto.subtle.importKey("spki",t,{name:"RSA-OAEP",hash:"SHA-256"},!1,["encrypt"]);case 3:for(a=e.sent,o=new TextEncoder,i=o.encode(r),s=[],c=0;c<i.length;c+=n)s.push(i.slice(c,c+n));return e.next=10,Promise.all(s.map((function(e){return window.crypto.subtle.encrypt({name:"RSA-OAEP"},a,e)})));case 10:return l=e.sent,d=l.reduce((function(e,t){return e+t.byteLength}),0),f=new Uint8Array(d),p=0,l.forEach((function(e){f.set(new Uint8Array(e),p),p+=e.byteLength})),e.abrupt("return",u.arrayBufferToBase64(f.buffer));case 16:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()),E(k,"decryptMessage",function(){var e=y(g().mark((function e(t,r){var n,a,o,i,s,c,l,d,f,p,h=arguments;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=h.length>2&&void 0!==h[2]?h[2]:256,a=u.base64ToArrayBuffer(r),e.next=4,window.crypto.subtle.importKey("pkcs8",t,{name:"RSA-OAEP",hash:"SHA-256"},!1,["decrypt"]);case 4:for(o=e.sent,i=[],s=0;s<a.byteLength;s+=n)i.push(a.slice(s,s+n));return e.next=9,Promise.all(i.map((function(e){return window.crypto.subtle.decrypt({name:"RSA-OAEP"},o,e)})));case 9:return c=e.sent,l=c.reduce((function(e,t){return e+t.byteLength}),0),d=new Uint8Array(l),f=0,c.forEach((function(e){d.set(new Uint8Array(e),f),f+=e.byteLength})),p=new TextDecoder,e.abrupt("return",p.decode(d));case 16:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()),E(k,"generateEncryptionKeyPair",y(g().mark((function e(){var t,r,n;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.crypto.subtle.generateKey({name:"RSA-OAEP",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:"SHA-256"},!0,["encrypt","decrypt"]);case 2:return t=e.sent,e.next=5,window.crypto.subtle.exportKey("spki",t.publicKey);case 5:return r=e.sent,e.next=8,window.crypto.subtle.exportKey("pkcs8",t.privateKey);case 8:return n=e.sent,e.abrupt("return",{publicKey:r,privateKey:n});case 10:case"end":return e.stop()}}),e)})))),E(k,"generateRandomString",(function(e){for(var t="",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=0;n<e;n++)t+=r.charAt(Math.floor(62*Math.random()));return t})),E(k,"arrayBufferToBase64",(function(e){for(var t=new Uint8Array(e),r="",n=t.byteLength,a=0;a<n;a++)r+=String.fromCharCode(t[a]);return btoa(r)})),E(k,"base64ToArrayBuffer",(function(e){for(var t=window.atob(e),r=t.length,n=new Uint8Array(r),a=0;a<r;a++)n[a]=t.charCodeAt(a);return n.buffer})),E(k,"chatboxScrollToBottom",(function(){var e,t,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=document.getElementById("chatbox");r?setTimeout((function(){n.style.scrollBehavior="smooth",n.scrollTop=n.scrollHeight}),500):(e=n,t=.4*Math.abs(e.scrollHeight-e.clientHeight),Math.abs(e.scrollHeight-e.clientHeight-e.scrollTop)<=t&&setTimeout((function(){n.style.scrollBehavior="smooth",n.scrollTop=n.scrollHeight}),500))})),E(k,"isEmptyOrSpaces",(function(e){return null===e||null!==e.match(/^ *$/)})),E(k,"formatTimestampIntoDaysOfWeek",(function(e){var t=new Date(parseInt(e)),r=new Date,n=new Date(r.getFullYear(),r.getMonth(),r.getDate()).getTime(),a=n-864e5,o=n-6048e5,i=new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime();return i>=n?"Today":i>=a&&i<n?"Yesterday":i>=o&&i<a?["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][t.getDay()]:e})),E(k,"reOrderUsersListIfNewMessageIsBeingSentOrReceived",(function(e){var t=document.getElementById("users-list"),r=document.getElementById("user".concat(e));t.removeChild(r),t.prepend(r)})),E(k,"isTimestampIsGreaterThanNminutes",(function(e,t){var r=60*t*1e3;return parseInt(e)>=Date.now()-r})),E(k,"saveCaretPosition",(function(e){var t=window.getSelection().getRangeAt(0),r=t.cloneRange();return r.selectNodeContents(e),r.setEnd(t.endContainer,t.endOffset),r.toString().length})),E(k,"restoreCaretPosition",(function(e,t){for(var r=window.getSelection(),n=document.createRange(),a=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,!1),o=a.nextNode(),i=0;o;){var s=o.length;if(i+s>=t){n.setStart(o,t-i),n.setEnd(o,t-i);break}i+=s,o=a.nextNode()}r.removeAllRanges(),r.addRange(n)})),E(k,"getUserAgentPlatformType",(function(){return d().getParser(window.navigator.userAgent).parsedResult.platform.type})),E(k,"hideMediaGroup",(function(){var e=document.getElementById("media-group");"mobile"==u.getUserAgentPlatformType()&&e.classList.add("hidden")})),E(k,"unHideMediaGroup",(function(){document.getElementById("media-group").classList.remove("hidden")})),E(k,"sortUsersListBaseOnLastMessageTimestamp",(function(){var e=document.getElementById("users-list");Array.from(e.children).sort((function(e,t){var r=parseInt(e.querySelector(".last-message").getAttribute("timestamp"));return parseInt(t.querySelector(".last-message").getAttribute("timestamp"))-r})).forEach((function(t){e.removeChild(t),e.appendChild(t)}))})),E(k,"isTotalImagesToSendNotExceeded",(function(e){if(e>5){var t="You can upload a maximum of ".concat(5," files, but you have attempted to upload ").concat(e," files.");return u.showAlertMessage("Maximum files to upload exceeded",t),!1}return!0})),E(k,"isImageFilesizeNotExceeded",(function(e){function t(e){if("number"!=typeof e||!Number.isInteger(e))throw new Error("Input must be an integer.");var t=["th","st","nd","rd"],r=e%100;return e+(t[(r-20)%10]||t[r]||t[0])}for(var r=0;r<e.length;r++){var n=h(e[r],2),a=(n[0],n[1].file.size);if(a>10485760){var o="The ".concat(t(r+1)," image size (").concat(Math.round(a/1048576)," MB) exceeds the maximum allowed filesize of 10 MB.");return u.showAlertMessage("Maximum upload filesize exceeded",o),!1}}return!0})),E(k,"showAlertMessage",(function(e,t){var r=document.getElementById("alert-message-container"),n=r.querySelector("#alert-message-title"),a=r.querySelector("#alert-message-content");n.textContent=e,a.textContent=t,r.classList.remove("hidden"),setTimeout((function(){r.classList.add("hidden")}),5e3)})),E(k,"progressSvgElementCallback",(function(e,t){var r=e.querySelector(".svgCircle"),n=e.querySelector(".progressCircle");e.querySelector(".double-check").classList.add("hidden"),100==t?r.classList.add("hidden"):(r.classList.remove("hidden"),n.setAttribute("stroke-dashoffset","calc(251.2px - (251.2px * ".concat(t-1," / 100))")))})),E(k,"reOrderLastFourChatboxElements",(function(){var e=document.getElementById("chatbox");Array.from(e.children).slice(-4).sort((function(e,t){return e.getAttribute("timestamp")-t.getAttribute("timestamp")})).forEach((function(t){e.removeChild(t),e.appendChild(t)}))})),E(k,"sleep",(function(e){return new Promise((function(t){return setTimeout(t,e)}))})),E(k,"setForwardUserUiDefaults",(function(e){e.forEach((function(e,t){var r=t,n=document.getElementById("forward-user-svg-sent-".concat(r)),a=document.getElementById("forward-user-svg-default-".concat(r)),o=document.getElementById("forward-user-span-text-".concat(r)),i=document.getElementById("forward-user-button-".concat(r));i.removeAttribute("disabled"),i.classList.remove("cursor-not-allowed"),i.classList.add("bg-indigo-600","dark:bg-indigo-300"),i.classList.remove("bg-gray-600","dark:bg-gray-300"),n.classList.add("hidden"),a.classList.remove("hidden"),o.textContent="Send"}))})),E(k,"setChatboxMessageAvatarHidden",(function(){for(var e=document.getElementById("chatbox"),t=Array.from(e.children),r=0;r<t.length-1;r++){var n=t[r],a=t[r+1],o=n.querySelector(".avatar"),i=a.querySelector(".avatar");null!=o&&null!=i&&o.classList.add("invisible")}})),E(k,"setChatboxMessageBorderAndMargin",(function(){for(var e=document.getElementById("chatbox"),t=Array.from(e.children),r=0;r<t.length-1;r++){var n=t[r],a=t[r+1],o=n.querySelector(".avatar"),i=a.querySelector(".avatar");if(null!=o&&null!=i)n.classList.remove("mb-5"),n.querySelector(".chat-message-container").classList.remove("rounded-bl-none"),r!=t.length-2&&a.classList.add("mb-5");else if(null==o&&null==i)try{n.classList.remove("mb-5"),n.querySelector(".chat-message-container").classList.remove("rounded-br-none"),r!=t.length-2&&a.classList.add("mb-5")}catch(e){}else r!=t.length-2&&(a.classList.add("mb-5"),a.classList.add("mt-5"))}})),E(k,"setChatboxDividerTimestamp",(function(){var e=document.getElementById("chatbox"),t=Array.from(e.children),r={year:"numeric",month:"long",day:"numeric"};e.querySelectorAll(".divider-timestamp").forEach((function(t){e.removeChild(t)}));for(var n=null,a=0;a<t.length;a++){var o=t[a],i=o.getAttribute("timestamp");if(null!=i){var s=new Date(parseInt(i)).toLocaleDateString("en-US",r);if(n!=s){var c=null,l=u.formatTimestampIntoDaysOfWeek(i);c=l==i?u.createDividerTimestampElement(s):u.createDividerTimestampElement(l),e.insertBefore(c,o)}n=s}}})),E(k,"setViewerJsImageElement",(function(e,t){var r=document.getElementById("viewerjs-images-container"),n=e.querySelector(".image"),a=n.getAttribute("url"),o=document.createElement("img");o.src=a;var i=document.createElement("li");i.appendChild(o),r.appendChild(i);var s=r.childNodes.length-1;t.update(),n.onclick=function(){t.show(),t.view(s)}})),E(k,"setUserLastMessageContent",(function(e,t){var r=document.getElementById("user".concat(e,"-last-message"));r.classList.remove("is-typing-loader","w-10"),r.textContent=t})),E(k,"setUserLastMessageTimestamp",(function(e,t){document.getElementById("user".concat(e,"-last-message")).setAttribute("timestamp",t)})),E(k,"setUserLastMessageTimeAgo",(function(e,t,r){var n=document.getElementById("user".concat(e,"-time-ago"));if(n.textContent="·"+r.format(t,"mini-now"),u.isTimestampIsGreaterThanNminutes(t,60))var a=setInterval((function(){document.getElementById("user".concat(e,"-last-message")).getAttribute("timestamp")!=t?clearInterval(a):n.textContent="·"+r.format(t,"mini-now")}),3e4)})),E(k,"setMessageTextElementTimeAgo",(function(e,t,r){e.textContent=r.format(t,"round"),u.isTimestampIsGreaterThanNminutes(t,60)&&setInterval((function(){e.textContent=r.format(t,"round")}),3e4)})),E(k,"setIntroductionElement",(function(e,t){var r=document.getElementById("chatbox"),n=document.createElement("div"),a=document.createElement("div");a.className="flex flex-col justify-center items-center absolute left-0 right-0 top-0 bottom-0";var o=document.createElement("div");o.className="w-16 h-16 rounded-full bg-contain bg-center shadow border border-gray-200 dark:border-gray-700 mb-2",o.style.backgroundImage="url('".concat(t,"')");var i=document.createElement("p");i.className="outline-none text-sm text-black opacity-80 dark:text-white dark:opacity-90 font-semibold leading-4 tracking-[.01rem] default-outline",i.tabIndex=0,i.textContent=e;var s=document.createElement("div");s.className="bg-indigo-50 dark:bg-gray-600 rounded p-3 mt-8 mx-5 sm:mx-0";var c=document.createElement("div");c.className="flex justify-center items-center gap-1";var u=document.createElementNS("http://www.w3.org/2000/svg","svg");u.setAttribute("viewBox","0 0 24 24"),u.setAttribute("fill","currentColor"),u.setAttribute("aria-hidden","true"),u.setAttribute("class","w-5 h-6 group-focus:text-indigo-400 hover:text-indigo-400 active:text-indigo-400 active:scale-110 dark:text-gray-500 transition ease-out duration-200 text-gray-300");var l=document.createElementNS("http://www.w3.org/2000/svg","path");l.setAttribute("fill-rule","evenodd"),l.setAttribute("d","M8 10V7a4 4 0 1 1 8 0v3h1a2 2 0 0 1 2 2v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h1Zm2-3a2 2 0 1 1 4 0v3h-4V7Zm2 6a1 1 0 0 1 1 1v3a1 1 0 1 1-2 0v-3a1 1 0 0 1 1-1Z"),l.setAttribute("clip-rule","evenodd"),u.appendChild(l);var d=document.createElement("span");d.className="flex align-middle outline-none text-xs text-black opacity-80 dark:text-white dark:opacity-90 font-bold leading-4 tracking-[.01rem] default-outline",d.tabIndex=0,d.textContent="End-to-end encrypted",c.appendChild(u),c.appendChild(d);var f=document.createElement("div");f.className="text-center mx-auto outline-none text-xs text-black opacity-80 dark:text-white dark:opacity-90 leading-4 tracking-[.01rem] default-outline",f.tabIndex=0,f.innerHTML='Messages and calls are secured with end-to-end encryption. <span class="text-blue-500">Learn more</span>',s.appendChild(c),s.appendChild(f),a.appendChild(o),a.appendChild(i),a.appendChild(s),n.appendChild(a),r.appendChild(n)})),E(k,"createDoubleCheckElement",(function(){var e=document.createElement("span");e.className="double-check flex items-center gap-x-1 text-xs text-gray-500 dark:text-neutral-500";var t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.setAttribute("class","shrink-0 size-3"),t.setAttribute("width","24"),t.setAttribute("height","24"),t.setAttribute("viewBox","0 0 24 24"),t.setAttribute("fill","none"),t.setAttribute("stroke","currentColor"),t.setAttribute("stroke-width","2"),t.setAttribute("stroke-linecap","round"),t.setAttribute("stroke-linejoin","round");var r=document.createElementNS("http://www.w3.org/2000/svg","path");r.setAttribute("d","M18 6 7 17l-5-5");var n=document.createElementNS("http://www.w3.org/2000/svg","path");n.setAttribute("d","m22 10-7.5 7.5L13 16"),t.appendChild(r),t.appendChild(n);var a=document.createElement("span");return a.className="text-node",a.textContent="Sending",e.appendChild(t),e.appendChild(a),e})),E(k,"createDividerTimestampElement",(function(e){var t=document.createElement("div");t.className="divider-timestamp w-full my-7 flex items-center justify-center";var r=document.createElement("div");r.className="w-full h-0 border-t border-dashed dark:border-gray-600 dark:bg-opacity-0";var n=document.createElement("p");n.className="outline-none text-xs font-light text-black opacity-80 dark:text-white dark:opacity-90 leading-4 tracking-[.01rem] mx-2 whitespace-nowrap",n.textContent=e;var a=document.createElement("div");return a.className="w-full h-0 border-t border-dashed dark:border-gray-600 dark:bg-opacity-0",t.appendChild(r),t.appendChild(n),t.appendChild(a),t})),E(k,"createProgressSvgElement",(function(){var e="http://www.w3.org/2000/svg",t=document.createElementNS(e,"svg");t.setAttribute("viewBox","0 0 100 100"),t.classList.add("svgCircle","w-12","h-12","hidden","absolute","inset-0","justify-center","self-center","m-auto");var r=document.createElementNS(e,"circle");r.setAttribute("cx","50"),r.setAttribute("cy","50"),r.setAttribute("r","40"),r.setAttribute("fill","transparent"),r.setAttribute("stroke-width","5"),r.classList.add("text-gray-200","stroke-current");var n=document.createElementNS(e,"circle");return n.setAttribute("cx","50"),n.setAttribute("cy","50"),n.setAttribute("r","40"),n.setAttribute("fill","transparent"),n.setAttribute("stroke-width","5"),n.setAttribute("stroke-linecap","round"),n.setAttribute("stroke-dasharray","251.2"),n.setAttribute("stroke-dashoffset","calc(251.2px - (251.2px * 1) / 100)"),n.classList.add("progressCircle","text-indigo-500","progress-ring__circle","stroke-current"),t.appendChild(r),t.appendChild(n),t})),E(k,"createLoaderElement",(function(){var e=localStorage.getItem("color-theme"),t=document.createElement("div");return t.className="dark"===e?"loader-white absolute":"loader-black absolute",t.style.left="calc(50% - 25px)",t.style.top="50%",t})),E(k,"createVoiceMessageElement",(function(e){var t=document.createElement("div");t.classList.add("group","w-full","self-center","rounded","transition","duration-500","bg-indigo-50","dark:bg-gray-600");var r=document.createElement("div");r.classList.add("flex","relative","items-center","outline-none","gap-2"),r.setAttribute("tabindex","0"),r.setAttribute("aria-label","audio message");var n=document.createElement("button");n.classList.add("px-2.5","py-2","flex","justify-center","items-center","rounded-[.75rem]","outline-none","transition-all","duration-200","bg-indigo-300","active:bg-indigo-400"),n.setAttribute("title","Play"),n.setAttribute("aria-label","Play"),n.type="button";var a=document.createElementNS("http://www.w3.org/2000/svg","svg");a.setAttribute("xmlns","http://www.w3.org/2000/svg"),a.setAttribute("fill","none"),a.setAttribute("viewBox","0 0 24 24"),a.setAttribute("stroke-width","1.5"),a.setAttribute("stroke","currentColor"),a.setAttribute("aria-hidden","true"),a.classList.add("w-3.5","h-3.5","text-white");var o=document.createElementNS("http://www.w3.org/2000/svg","path");o.setAttribute("stroke-linecap","round"),o.setAttribute("stroke-linejoin","round"),o.setAttribute("d","M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.348a1.125 1.125 0 010 1.971l-11.54 6.347a1.125 1.125 0 01-1.667-.985V5.653z"),a.appendChild(o);var i=document.createElementNS("http://www.w3.org/2000/svg","svg");i.setAttribute("xmlns","http://www.w3.org/2000/svg"),i.setAttribute("fill","none"),i.setAttribute("viewBox","0 0 24 24"),i.setAttribute("stroke-width","1.5"),i.setAttribute("stroke","currentColor"),i.setAttribute("aria-hidden","true"),i.classList.add("hidden","w-3.5","h-3.5","text-white");var s=document.createElementNS("http://www.w3.org/2000/svg","rect");s.setAttribute("width","12"),s.setAttribute("height","12"),s.setAttribute("x","6"),s.setAttribute("y","6"),s.setAttribute("stroke","currentColor"),s.setAttribute("stroke-linejoin","round"),s.setAttribute("stroke-width","2"),s.setAttribute("rx","1"),i.appendChild(s),n.appendChild(a),n.appendChild(i);var c=document.createElement("div");c.classList.add("w-36");var l=f.A.create({container:c,waveColor:"rgb(200, 0, 200)",progressColor:"#94a3b8",hideScrollbar:!0,autoCenter:!0,height:30,barHeight:25,barWidth:1.5,cursorWidth:0,url:e}),d=document.createElement("p");d.classList.add("outline-none","text-xs","font-light","leading-4","tracking-[.01rem]","text-black","dark:text-white","opacity-80","dark:opacity-90"),d.setAttribute("tabindex","0"),d.setAttribute("aria-label","00:00"),n.onclick=function(){return l.playPause()},l.on("ready",(function(e){var t=l.getDuration(),r=Math.floor(t/60),n=Math.floor(t%60),a="0".concat(r,":").concat(n.toString().padStart(2,"0"));d.textContent=a})),l.on("finish",(function(){l.seekTo(0)})),l.on("pause",(function(){a.classList.remove("hidden"),i.classList.add("hidden")})),l.on("play",(function(){a.classList.add("hidden"),i.classList.remove("hidden")})),l.on("timeupdate",(function(e){var t=Math.abs(l.getDuration()-e),r=Math.floor(t/60),n=Math.floor(t%60),a="0".concat(r,":").concat(n.toString().padStart(2,"0"));d.textContent=a}));var p=u.createProgressSvgElement();return r.appendChild(p),r.appendChild(n),r.appendChild(c),r.appendChild(d),t.appendChild(r),t})),E(k,"createImageMessageElement",(function(e){var t=document.createElement("div");t.className="outline-none cursor-pointer";var r=document.createElement("div");r.setAttribute("url",e),r.className="image relative rounded bg-cover bg-center w-56 h-56",r.style.backgroundImage='url("'.concat(e,'")');var n=u.createProgressSvgElement(),a=document.createElement("div");return a.className="w-full h-full flex justify-center items-center rounded bg-black bg-opacity-20 hover:bg-opacity-10 transition duration-200",r.appendChild(n),r.appendChild(a),t.appendChild(r),t})),E(k,"createVerticalThreeDotsOptionsElement",(function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3?arguments[3]:void 0,a=u;function o(e){for(var t=e;t.parentNode&&!t.getAttribute("messageId");)t=t.parentNode;return t}var i=document.createElement("btn"),s=document.createElementNS("http://www.w3.org/2000/svg","svg");s.classList.add("w-5","h-5","text-neutral-400"),s.setAttribute("aria-hidden","true"),s.setAttribute("fill","currentColor"),s.setAttribute("viewBox","0 0 24 24");var l=document.createElementNS("http://www.w3.org/2000/svg","path");l.setAttribute("d","M3.5 1.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Zm0 6.041a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Zm0 5.959a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Z"),s.appendChild(l);var d=function(e,i){var s=document.createElement("div"),u=new p.ms(s,e,{placement:i});s.classList.add("hidden","top-0","absolute","z-[100]","w-[12.5rem]","mt-2","rounded-lg","bg-white","dark:bg-gray-800","shadow-lg","border","border-gray-100","dark:border-gray-600","focus:outline-none"),s.setAttribute("role","menu"),s.setAttribute("aria-orientation","vertical"),s.setAttribute("aria-labelledby","menu-button"),s.setAttribute("tabindex","-1");var l=[{label:"Reply",iconPath:"M9 15L3 9m0 0l6-6M3 9h12a6 6 0 010 12h-3"},{label:"Copy",iconPath:"M8.25 7.5V6.108c0-1.135.845-2.098 1.976-2.192.373-.03.748-.057 1.123-.08M15.75 18H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08M15.75 18.75v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5A3.375 3.375 0 006.375 7.5H5.25m11.9-3.664A2.251 2.251 0 0015 2.25h-1.5a2.251 2.251 0 00-2.15 1.586m5.8 0c.065.21.1.433.1.664v.75h-6V4.5c0-.231.035-.454.1-.664M6.75 7.5H4.875c-.621 0-1.125.504-1.125 1.125v12c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V16.5a9 9 0 00-9-9z"},{label:"Forward",iconPath:"M4.248 19C3.22 15.77 5.275 8.232 12.466 8.232V6.079a1.025 1.025 0 0 1 1.644-.862l5.479 4.307a1.108 1.108 0 0 1 0 1.723l-5.48 4.307a1.026 1.026 0 0 1-1.643-.861v-2.154C5.275 13.616 4.248 19 4.248 19Z"}];return t!=c.AUDIO&&t!=c.IMAGE||l.splice(1,1),r||l.push({label:"Delete Message",iconPath:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"}),l.forEach((function(e){var r=document.createElement("button");r.classList.add("w-full","px-3","py-2.5","flex","items-center","border-b","opacity-60","dark:opacity-70","outline-none","text-sm","border-gray-200","dark:border-gray-600","transition-all","duration-200","text-black","hover:bg-gray-50","dark:hover:bg-gray-600","active:bg-gray-100","dark:focus:bg-gray-600"),"Delete Message"===e.label?r.classList.add("text-red-500","hover:bg-red-50","dark:hover:text-red-50","active:bg-red-100","dark:hover:bg-red-900"):r.classList.add("dark:text-white");var i=document.createElementNS("http://www.w3.org/2000/svg","svg");i.setAttribute("xmlns","http://www.w3.org/2000/svg"),i.setAttribute("fill","none"),i.setAttribute("viewBox","0 0 24 24"),i.setAttribute("stroke-width","1.5"),i.setAttribute("stroke","currentColor"),i.setAttribute("aria-hidden","true"),i.classList.add("h-4","w-4","mr-3");var l=document.createElementNS("http://www.w3.org/2000/svg","path");l.setAttribute("stroke-linecap","round"),l.setAttribute("stroke-linejoin","round"),l.setAttribute("d",e.iconPath),i.appendChild(l),r.appendChild(i),r.appendChild(document.createTextNode(e.label)),r.onclick=y(g().mark((function i(){var s,l,d,f,p,h,m,v,y,b,w,x,E,L,k,M,C,A,I,T,S,O;return g().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(u.hide(),"Reply"!=e.label){i.next=4;break}i.next=69;break;case 4:if("Copy"!=e.label){i.next=11;break}return s=o(r),l=JSON.parse(s.getAttribute("messageData")),i.next=9,s.copyTextMessageCallback(l.content);case 9:i.next=69;break;case 11:if("Forward"!=e.label){i.next=42;break}if(d=document.getElementById("static-modal-forward-users-list-button"),f=o(r),p=JSON.parse(f.getAttribute("messageData")),d.click(),t!=c.TEXT){i.next=20;break}f.forwardMessageCallback(t,p.content,null,null,null),i.next=40;break;case 20:if(t!=c.AUDIO){i.next=30;break}return i.next=23,fetch(p.content);case 23:return h=i.sent,i.next=26,h.blob();case 26:m=i.sent,f.forwardMessageCallback(t,null,m,null,null),i.next=40;break;case 30:if(t!=c.IMAGE){i.next=40;break}return i.next=33,fetch(p.content);case 33:return v=i.sent,i.next=36,v.blob();case 36:y=i.sent,(b=document.createElement("img")).src=URL.createObjectURL(y),b.onload=function(){var e=y.type,r="output."+e.split("/")[1];f.forwardMessageCallback(t,null,y,e,r)};case 40:i.next=69;break;case 42:if("Delete Message"!=e.label){i.next=69;break}w=o(r),x=w.getAttribute("uid"),E=w.getAttribute("messageId"),(L=document.getElementById("chatbox")).removeChild(w),a.chatboxScrollToBottom(),a.reOrderLastFourChatboxElements(),a.setChatboxMessageAvatarHidden(),a.setChatboxDividerTimestamp(),a.setChatboxMessageBorderAndMargin(),k=null,M=L.children.length-1;case 55:if(!(M>=0)){i.next=62;break}if(!(k=L.children[M]).getAttribute("lastMessageContent")){i.next=59;break}return i.abrupt("break",62);case 59:M--,i.next=55;break;case 62:return C=null,A=null,k.getAttribute("lastMessageContent")?(A=k.getAttribute("currentUserId"),I=k.getAttribute("lastMessageContent"),T=JSON.parse(k.getAttribute("messageData")),S=T.sender,C=T.sender,A==T.sender&&(S=T.receiver,C=T.receiver),a.setUserLastMessageContent(S,I),a.setUserLastMessageTimestamp(S,T.timestamp),a.setUserLastMessageTimeAgo(S,T.timestamp,n),a.reOrderUsersListIfNewMessageIsBeingSentOrReceived(S)):(O=JSON.parse(w.getAttribute("messageData")),a.setUserLastMessageContent(O.receiver,"..."),a.setUserLastMessageTimestamp(O.receiver,1),a.reOrderUsersListIfNewMessageIsBeingSentOrReceived(O.receiver)),a.sortUsersListBaseOnLastMessageTimestamp(),i.next=68,w.deleteMessageCallback(x,E,"delete_message-".concat(A,"-").concat(C),"".concat(A,"-").concat(C));case 68:i.sent;case 69:case"end":return i.stop()}}),i)}))),s.appendChild(r)})),[s,u]}(i,e),f=h(d,2),m=f[0],v=f[1];return i.classList.add("invisible","cursor-pointer"),i.appendChild(s),i.onclick=function(){v.show()},[i,m]})),E(k,"createOutgoingMessageTextElement",(function(e,t,r){var n=document.createElement("div");n.setAttribute("timestamp",t);var a=document.createElement("div");a.classList.add("select-none");var o=document.createElement("div");o.classList.add("flex","justify-end");var i=document.createElement("div");i.classList.add("mr-4");var s=document.createElement("div");s.classList.add("flex","relative","items-end");var l=document.createElement("div");l.classList.add("chat-message-container","group","max-w-[31.25rem]","p-4","transition","duration-500","rounded-lg","rounded-br-none","order-2","bg-indigo-50","dark:bg-gray-600");var d=document.createElement("p");d.classList.add("whitespace-pre-wrap","break-all","text-sm","font-normal","leading-4","tracking-[.01rem]","outline-none","text-black","opacity-80","dark:text-white","dark:opacity-90"),d.setAttribute("tabindex","0"),d.textContent=e,l.appendChild(d);var f=document.createElement("div");f.classList.add("ml-1.5","order-1");var p=document.createElement("p");p.classList.add("hidden","flex","justify-end","outline-none","text-xs","text-black","opacity-80","dark:text-white","dark:opacity-90","font-light","leading-4","tracking-[.01rem]","whitespace-pre"),p.textContent=t,u.setMessageTextElementTimeAgo(p,t,r),n.appendChild(p);var m=document.createElement("div"),g=h(u.createVerticalThreeDotsOptionsElement("top-end",c.TEXT,!1,r),2),v=g[0],y=g[1];m.style.height="100%",m.classList.add("flex","flex-col","justify-between","items-center");var b=u.createDoubleCheckElement();return m.appendChild(v),m.appendChild(b),m.appendChild(y),s.appendChild(l),s.appendChild(f),s.appendChild(m),o.appendChild(i),o.appendChild(s),a.appendChild(o),n.appendChild(a),n.onclick=function(){p.classList.remove("hidden"),v.classList.remove("invisible")},n})),E(k,"createOutgoingMessageVoiceElement",(function(e,t,r){var n=document.createElement("div");n.setAttribute("timestamp",t);var a=document.createElement("div");a.classList.add("select-none");var o=document.createElement("div");o.classList.add("flex","justify-end");var i=document.createElement("div");i.classList.add("mr-4");var s=document.createElement("div");s.classList.add("flex","items-end");var l=document.createElement("div");l.classList.add("chat-message-container","group","max-w-[31.25rem]","p-4","transition","duration-500","rounded-lg","rounded-br-none","order-2","bg-indigo-50","dark:bg-gray-600");var d=document.createElement("p");d.classList.add("whitespace-pre-wrap","break-all","text-sm","font-normal","leading-4","tracking-[.01rem]","outline-none","text-black","opacity-80","dark:text-white","dark:opacity-90"),d.setAttribute("tabindex","0");var f=u.createVoiceMessageElement(e);l.appendChild(f);var p=document.createElement("div");p.classList.add("ml-1.5","order-1");var m=document.createElement("p");m.classList.add("hidden","flex","justify-end","outline-none","text-xs","text-black","opacity-80","dark:text-white","dark:opacity-90","font-light","leading-4","tracking-[.01rem]","whitespace-pre"),m.textContent=t,u.setMessageTextElementTimeAgo(m,t,r),n.appendChild(m);var g=document.createElement("div"),v=h(u.createVerticalThreeDotsOptionsElement("top-end",c.AUDIO,!1,r),2),y=v[0],b=v[1];g.style.height="100%",g.classList.add("flex","flex-col","justify-between","items-center");var w=u.createDoubleCheckElement();return g.appendChild(y),g.appendChild(w),g.appendChild(b),s.appendChild(l),s.appendChild(p),s.appendChild(g),o.appendChild(i),o.appendChild(s),a.appendChild(o),n.appendChild(a),n.onclick=function(){m.classList.remove("hidden"),y.classList.remove("invisible")},n})),E(k,"createOutgoingMessageImageElement",(function(e,t,r){var n=document.createElement("div");n.setAttribute("timestamp",t);var a=document.createElement("div");a.classList.add("select-none");var o=document.createElement("div");o.classList.add("flex","justify-end");var i=document.createElement("div");i.classList.add("mr-4");var s=document.createElement("div");s.classList.add("flex","relative","items-end");var l=document.createElement("div");l.classList.add("chat-message-container","group","max-w-[31.25rem]","transition","duration-500","rounded-lg","rounded-br-none","order-2","bg-indigo-50","dark:bg-gray-600");var d=u.createImageMessageElement(e);l.appendChild(d);var f=document.createElement("div");f.classList.add("ml-1.5","order-1");var p=document.createElement("p");p.classList.add("hidden","flex","justify-end","outline-none","text-xs","text-black","opacity-80","dark:text-white","dark:opacity-90","font-light","leading-4","tracking-[.01rem]","whitespace-pre"),p.textContent=t,u.setMessageTextElementTimeAgo(p,t,r),n.appendChild(p);var m=document.createElement("div"),g=h(u.createVerticalThreeDotsOptionsElement("top-end",c.IMAGE,!1,r),2),v=g[0],y=g[1];m.style.height="100%",m.classList.add("flex","flex-col","justify-between","items-center");var b=u.createDoubleCheckElement();return m.appendChild(v),m.appendChild(b),m.appendChild(y),s.appendChild(l),s.appendChild(f),s.appendChild(m),o.appendChild(i),o.appendChild(s),a.appendChild(o),n.appendChild(a),n.onclick=function(){p.classList.remove("hidden"),v.classList.remove("invisible")},n})),E(k,"createIncomingMessageTextElement",(function(e,t,r,n){var a=document.createElement("div");a.setAttribute("timestamp",r);var o=document.createElement("div");o.classList.add("select-none");var i=document.createElement("div");i.classList.add("flex");var s=document.createElement("div");s.classList.add("mr-4","flex","items-end");var l=document.createElement("div");l.classList.add("outline-none");var d=document.createElement("div");d.classList.add("avatar","w-[2.25rem]","h-[2.25rem]","bg-cover","bg-center","rounded-full"),d.style.backgroundImage='url("'.concat(t,'")'),l.appendChild(d),s.appendChild(l);var f=document.createElement("div");f.classList.add("flex","items-end");var p=document.createElement("div");p.classList.add("chat-message-container","group","max-w-[31.25rem]","p-4","transition","duration-500","rounded-lg","rounded-bl-none","mr-4","bg-gray-100","dark:bg-gray-600");var m=document.createElement("p");m.classList.add("whitespace-pre-wrap","break-all","text-sm","font-normal","leading-4","tracking-[.01rem]","outline-none","text-black","opacity-80","dark:text-white","dark:opacity-90"),m.setAttribute("tabindex","0"),m.textContent=e,p.appendChild(m);var g=document.createElement("div"),v=document.createElement("p");v.classList.add("hidden","pl-12","outline-none","text-xs","text-black","opacity-80","dark:text-white","dark:opacity-90","font-light","leading-4","tracking-[.01rem]","whitespace-pre"),v.textContent=r,u.setMessageTextElementTimeAgo(v,r,n),a.append(v);var y=h(u.createVerticalThreeDotsOptionsElement("top-start",c.TEXT,!0,n),2),b=y[0],w=y[1];return f.appendChild(p),f.appendChild(g),i.appendChild(s),i.appendChild(f),i.appendChild(b),i.appendChild(w),o.appendChild(i),a.appendChild(o),a.onclick=function(){v.classList.remove("hidden"),b.classList.remove("invisible")},a})),E(k,"createIncomingMessageVoiceElement",(function(e,t,r,n){var a=document.createElement("div");a.setAttribute("timestamp",r);var o=document.createElement("div");o.classList.add("select-none");var i=document.createElement("div");i.classList.add("flex");var s=document.createElement("div");s.classList.add("mr-4","flex","items-end");var l=document.createElement("div");l.classList.add("outline-none");var d=document.createElement("div");d.classList.add("avatar","w-[2.25rem]","h-[2.25rem]","bg-cover","bg-center","rounded-full"),d.style.backgroundImage='url("'.concat(t,'")'),l.appendChild(d),s.appendChild(l);var f=document.createElement("div");f.classList.add("flex","items-end");var p=document.createElement("div");p.classList.add("chat-message-container","group","max-w-[31.25rem]","p-4","transition","duration-500","rounded-lg","rounded-bl-none","mr-4","bg-gray-100","dark:bg-gray-600");var m=document.createElement("p");m.classList.add("whitespace-pre-wrap","break-all","text-sm","font-normal","leading-4","tracking-[.01rem]","outline-none","text-black","opacity-80","dark:text-white","dark:opacity-90"),m.setAttribute("tabindex","0");var g=u.createVoiceMessageElement(e);p.appendChild(g);var v=document.createElement("div"),y=document.createElement("p");y.classList.add("hidden","pl-12","outline-none","text-xs","text-black","opacity-80","dark:text-white","dark:opacity-90","font-light","leading-4","tracking-[.01rem]","whitespace-pre"),y.textContent=r,u.setMessageTextElementTimeAgo(y,r,n),a.append(y);var b=h(u.createVerticalThreeDotsOptionsElement("top-start",c.AUDIO,!0,n),2),w=b[0],x=b[1];return f.appendChild(p),f.appendChild(v),i.appendChild(s),i.appendChild(f),i.appendChild(w),i.appendChild(x),o.appendChild(i),a.appendChild(o),a.onclick=function(){y.classList.remove("hidden"),w.classList.remove("invisible")},a})),E(k,"createIncommingMessageImageElement",(function(e,t,r,n){var a=document.createElement("div");a.setAttribute("timestamp",r);var o=document.createElement("div");o.classList.add("select-none");var i=document.createElement("div");i.classList.add("flex");var s=document.createElement("div");s.classList.add("mr-4","flex","items-end");var l=document.createElement("div");l.classList.add("outline-none");var d=document.createElement("div");d.classList.add("avatar","w-[2.25rem]","h-[2.25rem]","bg-cover","bg-center","rounded-full"),d.style.backgroundImage='url("'.concat(t,'")'),l.appendChild(d),s.appendChild(l);var f=document.createElement("div");f.classList.add("flex","items-end");var p=document.createElement("div");p.classList.add("chat-message-container","group","max-w-[31.25rem]","transition","duration-500","rounded-lg","rounded-bl-none","mr-4","bg-gray-100","dark:bg-gray-600");var m=u.createImageMessageElement(e);p.appendChild(m);var g=document.createElement("div"),v=document.createElement("p");v.classList.add("hidden","pl-12","outline-none","text-xs","text-black","opacity-80","dark:text-white","dark:opacity-90","font-light","leading-4","tracking-[.01rem]","whitespace-pre"),v.textContent=r,u.setMessageTextElementTimeAgo(v,r,n),a.append(v);var y=h(u.createVerticalThreeDotsOptionsElement("top-start",c.IMAGE,!0,n),2),b=y[0],w=y[1];return f.appendChild(p),f.appendChild(g),i.appendChild(s),i.appendChild(f),i.appendChild(b),i.appendChild(w),o.appendChild(i),a.appendChild(o),a.onclick=function(){v.classList.remove("hidden"),b.classList.remove("invisible")},a})),E(k,"createIncomingIsTypingElement",(function(e){var t=document.createElement("div"),r=document.createElement("div");r.classList.add("select-none");var n=document.createElement("div");n.classList.add("flex");var a=document.createElement("div");a.classList.add("mr-4","flex","items-end");var o=document.createElement("div");o.classList.add("outline-none");var i=document.createElement("div");i.classList.add("avatar","w-[2.25rem]","h-[2.25rem]","bg-cover","bg-center","rounded-full"),i.style.backgroundImage='url("'.concat(e,'")'),o.appendChild(i),a.appendChild(o);var s=document.createElement("div");s.classList.add("flex","items-end");var c=document.createElement("div");c.classList.add("chat-message-container","group","max-w-[31.25rem]","p-4","transition","duration-500","rounded-lg","rounded-bl-none","mr-4","bg-gray-100","dark:bg-gray-600");var u=document.createElement("p");u.classList.add("is-typing-loader","w-10","whitespace-pre-wrap","break-all","text-sm","font-normal","leading-4","tracking-[.01rem]","outline-none","text-black","opacity-80","dark:text-white","dark:opacity-90"),u.setAttribute("tabindex","0"),c.appendChild(u);var l=document.createElement("div");return s.appendChild(c),s.appendChild(l),n.appendChild(a),n.appendChild(s),r.appendChild(n),t.appendChild(r),t}));var M=r(1083);function C(e){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},C(e)}function A(){A=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,a=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var o=t&&t.prototype instanceof v?t:v,i=Object.create(o.prototype),s=new j(n||[]);return a(i,"_invoke",{value:I(e,r,s)}),i}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var f="suspendedStart",p="suspendedYield",h="executing",m="completed",g={};function v(){}function y(){}function b(){}var w={};u(w,i,(function(){return this}));var x=Object.getPrototypeOf,E=x&&x(x(P([])));E&&E!==r&&n.call(E,i)&&(w=E);var L=b.prototype=v.prototype=Object.create(w);function k(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function M(e,t){function r(a,o,i,s){var c=d(e[a],e,o);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==C(l)&&n.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,i,s)}),(function(e){r("throw",e,i,s)})):t.resolve(l).then((function(e){u.value=e,i(u)}),(function(e){return r("throw",e,i,s)}))}s(c.arg)}var o;a(this,"_invoke",{value:function(e,n){function a(){return new t((function(t,a){r(e,n,t,a)}))}return o=o?o.then(a,a):a()}})}function I(t,r,n){var a=f;return function(o,i){if(a===h)throw Error("Generator is already running");if(a===m){if("throw"===o)throw i;return{value:e,done:!0}}for(n.method=o,n.arg=i;;){var s=n.delegate;if(s){var c=T(s,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===f)throw a=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=h;var u=d(t,r,n);if("normal"===u.type){if(a=n.done?m:p,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(a=m,n.method="throw",n.arg=u.arg)}}}function T(t,r){var n=r.method,a=t.iterator[n];if(a===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,T(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=d(a,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,g;var i=o.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function j(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function P(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,o=function r(){for(;++a<t.length;)if(n.call(t,a))return r.value=t[a],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(C(t)+" is not iterable")}return y.prototype=b,a(L,"constructor",{value:b,configurable:!0}),a(b,"constructor",{value:y,configurable:!0}),y.displayName=u(b,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,u(e,c,"GeneratorFunction")),e.prototype=Object.create(L),e},t.awrap=function(e){return{__await:e}},k(M.prototype),u(M.prototype,s,(function(){return this})),t.AsyncIterator=M,t.async=function(e,r,n,a,o){void 0===o&&(o=Promise);var i=new M(l(e,r,n,a),o);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},k(L),u(L,c,"Generator"),u(L,i,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=P,j.prototype={constructor:j,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function a(n,a){return s.type="throw",s.arg=t,r.next=n,a&&(r.method="next",r.arg=e),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],s=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;O(r)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:P(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function I(e,t,r,n,a,o,i){try{var s=e[o](i),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,a)}function T(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){I(o,n,a,i,s,"next",e)}function s(e){I(o,n,a,i,s,"throw",e)}i(void 0)}))}}function S(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,P(n.key),n)}}function O(e,t,r){return t&&S(e.prototype,t),r&&S(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function j(e,t,r){return(t=P(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function P(e){var t=function(e,t){if("object"!=C(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=C(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==C(t)?t:t+""}var U=O((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),j(this,"setEncryptionDetails",function(){var e=T(A().mark((function e(t,r,n,a){var o,i;return A().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(o=new FormData).append("uid",t),o.append("publickey",r),o.append("privatekey",n),o.append("passphrase",a),e.prev=5,e.next=8,fetch("/set_encryption_details",{method:"POST",body:o});case 8:return i=e.sent,e.next=11,i;case 11:return e.abrupt("return",e.sent);case 14:return e.prev=14,e.t0=e.catch(5),e.abrupt("return",{ok:!1});case 17:case"end":return e.stop()}}),e,null,[[5,14]])})));return function(t,r,n,a){return e.apply(this,arguments)}}()),j(this,"createTextMessage",function(){var e=T(A().mark((function e(t,r,n,a,o,i,s,c){var u,l,d,f=arguments;return A().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=!(f.length>8&&void 0!==f[8])||f[8],(l=new FormData).append("uid",t),l.append("event",r),l.append("channels",n),l.append("sender",a),l.append("receiver",o),l.append("type",i),l.append("content",s),l.append("timestamp",c),l.append("isSaveMessage",u),e.prev=11,e.next=14,fetch("/create_text_message",{method:"POST",body:l});case 14:return d=e.sent,e.next=17,d;case 17:return e.abrupt("return",e.sent);case 20:return e.prev=20,e.t0=e.catch(11),e.abrupt("return",{ok:!1});case 23:case"end":return e.stop()}}),e,null,[[11,20]])})));return function(t,r,n,a,o,i,s,c){return e.apply(this,arguments)}}()),j(this,"createAudioMessage",function(){var e=T(A().mark((function e(t,r,n,a){var o,i;return A().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(o=new FormData).append("uid",t),o.append("file",r),e.prev=3,e.next=6,M.A.post("/create_audio_message",o,{onUploadProgress:function(e){var t=Math.round(100*e.loaded/e.total);a(n,t)}});case 6:return i=e.sent,a(n,100),e.abrupt("return",i);case 11:return e.prev=11,e.t0=e.catch(3),e.abrupt("return",{status:500});case 14:case"end":return e.stop()}}),e,null,[[3,11]])})));return function(t,r,n,a){return e.apply(this,arguments)}}()),j(this,"createImageMessage",function(){var e=T(A().mark((function e(t,r,n,a,o){var i,s;return A().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(i=new FormData).append("uid",t),i.append("file",r),i.append("extension",n),e.prev=4,e.next=7,M.A.post("/create_image_message",i,{onUploadProgress:function(e){var t=Math.round(100*e.loaded/e.total);o(a,t)}});case 7:return s=e.sent,o(a,100),e.abrupt("return",s);case 12:return e.prev=12,e.t0=e.catch(4),e.abrupt("return",{status:500});case 15:case"end":return e.stop()}}),e,null,[[4,12]])})));return function(t,r,n,a,o){return e.apply(this,arguments)}}()),j(this,"deleteMessage",function(){var e=T(A().mark((function e(t,r,n,a){var o;return A().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/delete_message/".concat(t,"/").concat(r,"/").concat(n,"/").concat(a),{method:"DELETE"});case 3:return o=e.sent,e.next=6,o;case 6:return e.abrupt("return",e.sent);case 9:return e.prev=9,e.t0=e.catch(0),e.abrupt("return",{ok:!1});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t,r,n,a){return e.apply(this,arguments)}}()),j(this,"sendTypingNotification",function(){var e=T(A().mark((function e(t,r,n,a){var o,i;return A().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(o=new FormData).append("uid",t),o.append("event",r),o.append("channels",n),o.append("isTyping",a),e.prev=5,e.next=8,fetch("/send_typing_notification",{method:"POST",body:o});case 8:return i=e.sent,e.next=11,i;case 11:return e.abrupt("return",e.sent);case 14:return e.prev=14,e.t0=e.catch(5),e.abrupt("return",{ok:!1});case 17:case"end":return e.stop()}}),e,null,[[5,14]])})));return function(t,r,n,a){return e.apply(this,arguments)}}()),j(this,"getUserLastSeen",function(){var e=T(A().mark((function e(t,r){var n;return A().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/get_user_last_seen/".concat(t,"/").concat(r),{method:"GET"});case 3:return n=e.sent,e.next=6,n;case 6:return e.abrupt("return",e.sent);case 9:return e.prev=9,e.t0=e.catch(0),e.abrupt("return",{ok:!1});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t,r){return e.apply(this,arguments)}}()),j(this,"setSeenMessage",function(){var e=T(A().mark((function e(t,r,n){var a,o;return A().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=new FormData).append("uid",t),a.append("sender",r),a.append("id",n),e.prev=4,e.next=7,fetch("/set_seen_message",{method:"POST",body:a});case 7:return o=e.sent,e.next=10,o;case 10:return e.abrupt("return",e.sent);case 13:return e.prev=13,e.t0=e.catch(4),e.abrupt("return",{ok:!1});case 16:case"end":return e.stop()}}),e,null,[[4,13]])})));return function(t,r,n){return e.apply(this,arguments)}}()),j(this,"getMessages",function(){var e=T(A().mark((function e(t,r,n,a,o){var i,s,c=arguments;return A().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=c.length>5&&void 0!==c[5]?c[5]:0,e.prev=1,e.next=4,fetch("/get_messages/".concat(t,"/").concat(r,"/").concat(n,"/").concat(a,"/").concat(o,"/").concat(i),{method:"GET"});case 4:return s=e.sent,e.next=7,s;case 7:return e.abrupt("return",e.sent);case 10:return e.prev=10,e.t0=e.catch(1),e.abrupt("return",{ok:!1});case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t,r,n,a,o){return e.apply(this,arguments)}}()),j(this,"getLastMessages",function(){var e=T(A().mark((function e(t,r){var n;return A().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/get_last_messages/".concat(t,"/").concat(r),{method:"GET"});case 3:return n=e.sent,e.next=6,n;case 6:return e.abrupt("return",e.sent);case 9:return e.prev=9,e.t0=e.catch(0),e.abrupt("return",{ok:!1});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t,r){return e.apply(this,arguments)}}()),j(this,"getUsers",function(){var e=T(A().mark((function e(t){var r;return A().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/get_users/".concat(t),{method:"GET"});case 3:return r=e.sent,e.next=6,r;case 6:return e.abrupt("return",e.sent);case 9:return e.prev=9,e.t0=e.catch(0),e.abrupt("return",{ok:!1});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}())})),B=(r(2762),r(1013));function _(e){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_(e)}function N(){N=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,a=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var o=t&&t.prototype instanceof v?t:v,i=Object.create(o.prototype),s=new S(n||[]);return a(i,"_invoke",{value:C(e,r,s)}),i}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var f="suspendedStart",p="suspendedYield",h="executing",m="completed",g={};function v(){}function y(){}function b(){}var w={};u(w,i,(function(){return this}));var x=Object.getPrototypeOf,E=x&&x(x(O([])));E&&E!==r&&n.call(E,i)&&(w=E);var L=b.prototype=v.prototype=Object.create(w);function k(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function M(e,t){function r(a,o,i,s){var c=d(e[a],e,o);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==_(l)&&n.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,i,s)}),(function(e){r("throw",e,i,s)})):t.resolve(l).then((function(e){u.value=e,i(u)}),(function(e){return r("throw",e,i,s)}))}s(c.arg)}var o;a(this,"_invoke",{value:function(e,n){function a(){return new t((function(t,a){r(e,n,t,a)}))}return o=o?o.then(a,a):a()}})}function C(t,r,n){var a=f;return function(o,i){if(a===h)throw Error("Generator is already running");if(a===m){if("throw"===o)throw i;return{value:e,done:!0}}for(n.method=o,n.arg=i;;){var s=n.delegate;if(s){var c=A(s,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===f)throw a=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=h;var u=d(t,r,n);if("normal"===u.type){if(a=n.done?m:p,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(a=m,n.method="throw",n.arg=u.arg)}}}function A(t,r){var n=r.method,a=t.iterator[n];if(a===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=d(a,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,g;var i=o.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function O(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,o=function r(){for(;++a<t.length;)if(n.call(t,a))return r.value=t[a],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(_(t)+" is not iterable")}return y.prototype=b,a(L,"constructor",{value:b,configurable:!0}),a(b,"constructor",{value:y,configurable:!0}),y.displayName=u(b,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,u(e,c,"GeneratorFunction")),e.prototype=Object.create(L),e},t.awrap=function(e){return{__await:e}},k(M.prototype),u(M.prototype,s,(function(){return this})),t.AsyncIterator=M,t.async=function(e,r,n,a,o){void 0===o&&(o=Promise);var i=new M(l(e,r,n,a),o);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},k(L),u(L,c,"Generator"),u(L,i,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=O,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(T),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function a(n,a){return s.type="throw",s.arg=t,r.next=n,a&&(r.method="next",r.arg=e),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],s=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),T(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;T(r)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:O(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function D(e,t,r,n,a,o,i){try{var s=e[o](i),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,a)}function F(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){D(o,n,a,i,s,"next",e)}function s(e){D(o,n,a,i,s,"throw",e)}i(void 0)}))}}function G(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,R(n.key),n)}}function H(e,t,r){return t&&G(e.prototype,t),r&&G(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function V(e,t,r){return(t=R(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function R(e){var t=function(e,t){if("object"!=_(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==_(t)?t:t+""}var J=H((function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),V(this,"init",(function(e,r,n,a,o,i){t.uid=e,t.currentUser=r,t.userToChatId=n,t.currentUserPublickey=a,t.forwardMessageHandler=i,t.usersMap=o})),V(this,"setButtonClick",(function(){var e=document.getElementById("chatbox-message-input");document.getElementById("send-text-button").onclick=F(N().mark((function r(){var n;return N().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=e.innerText.trim(),k.isEmptyOrSpaces(n)){r.next=4;break}return r.next=4,t.sendMessage(t.userToChatId,n);case 4:case"end":return r.stop()}}),r)})))})),V(this,"setInputKeyDown",(function(){document.getElementById("chatbox-message-input").onkeydown=function(){var e=F(N().mark((function e(r){var n;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.target.innerText.trim(),"desktop"!=k.getUserAgentPlatformType()){e.next=7;break}if("Enter"!==r.key||r.shiftKey){e.next=7;break}if(r.preventDefault(),k.isEmptyOrSpaces(n)){e.next=7;break}return e.next=7,t.sendMessage(t.userToChatId,n);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()})),V(this,"sendMessage",function(){var e=F(N().mark((function e(r,n){var a,o,i,s,u,l,d,f;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.getElementById("chatbox-message-input").textContent="",a=c.TEXT,o=Date.now(),i=JSON.stringify({sender:t.currentUser.id,receiver:r,type:a,content:n,timestamp:o}),s=t.usersMap.get(r).userDetails.publickey.publickey,u=k.base64ToArrayBuffer(s),e.next=9,k.encryptMessage(t.currentUserPublickey,i);case 9:return l=e.sent,e.next=12,k.encryptMessage(u,i);case 12:return d=e.sent,f=btoa(JSON.stringify({sender:l,receiver:d})),e.next=16,t.setSendMessage(r,n,f,o,i);case 16:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()),V(this,"setSendMessage",function(){var e=F(N().mark((function e(r,n,a,o,i){var s,u,l,d,f,p;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=document.getElementById("chatbox"),(u=k.createOutgoingMessageTextElement(n,o,t.timeAgo)).setAttribute("messageData",i),u.setAttribute("lastMessageContent",n),u.setAttribute("currentUserId",t.currentUser.id),u.copyTextMessageCallback=t.forwardMessageHandler.copyTextMessageCallback,u.forwardMessageCallback=t.forwardMessageHandler.forwardMessageCallback,u.deleteMessageCallback=t.service.deleteMessage,t.userToChatId==r&&(k.chatboxScrollToBottom(!0),s.appendChild(u)),k.reOrderLastFourChatboxElements(),k.setChatboxMessageAvatarHidden(),k.setChatboxDividerTimestamp(),k.setChatboxMessageBorderAndMargin(),e.next=15,t.service.createTextMessage(t.uid,"messages/".concat(t.currentUser.id,"/").concat(r),"".concat(t.currentUser.id,"-").concat(r),t.currentUser.id,r,c.TEXT,a,o,!0);case 15:if(l=e.sent,d=u.querySelector(".double-check"),!l.ok){e.next=33;break}return e.next=20,l.json();case 20:f=e.sent,p=f.id,u.setAttribute("uid",t.uid),u.setAttribute("messageId",p),d.classList.remove("text-gray-500","dark:text-neutral-500"),d.classList.add("text-green-500","dark:text-green-500"),d.querySelector(".text-node").textContent="Sent",k.setUserLastMessageContent(r,n),k.setUserLastMessageTimestamp(r,o),k.setUserLastMessageTimeAgo(r,o,t.timeAgo),k.reOrderUsersListIfNewMessageIsBeingSentOrReceived(r),e.next=36;break;case 33:d.classList.remove("text-gray-500","dark:text-neutral-500"),d.classList.add("text-red-500","dark:text-red-500"),d.querySelector(".text-node").textContent="Failed";case 36:case"end":return e.stop()}}),e)})));return function(t,r,n,a,o){return e.apply(this,arguments)}}()),this.uid=null,this.currentUser=null,this.userToChatId=null,this.currentUserPublickey=null,this.forwardMessageHandler=null,this.usersMap=new Map,this.timeAgo=new B.A("en-US"),this.service=new U})),Y=(r(8598),r(7147));function q(e){return q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},q(e)}function z(){z=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,a=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var o=t&&t.prototype instanceof v?t:v,i=Object.create(o.prototype),s=new S(n||[]);return a(i,"_invoke",{value:C(e,r,s)}),i}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var f="suspendedStart",p="suspendedYield",h="executing",m="completed",g={};function v(){}function y(){}function b(){}var w={};u(w,i,(function(){return this}));var x=Object.getPrototypeOf,E=x&&x(x(O([])));E&&E!==r&&n.call(E,i)&&(w=E);var L=b.prototype=v.prototype=Object.create(w);function k(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function M(e,t){function r(a,o,i,s){var c=d(e[a],e,o);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==q(l)&&n.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,i,s)}),(function(e){r("throw",e,i,s)})):t.resolve(l).then((function(e){u.value=e,i(u)}),(function(e){return r("throw",e,i,s)}))}s(c.arg)}var o;a(this,"_invoke",{value:function(e,n){function a(){return new t((function(t,a){r(e,n,t,a)}))}return o=o?o.then(a,a):a()}})}function C(t,r,n){var a=f;return function(o,i){if(a===h)throw Error("Generator is already running");if(a===m){if("throw"===o)throw i;return{value:e,done:!0}}for(n.method=o,n.arg=i;;){var s=n.delegate;if(s){var c=A(s,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===f)throw a=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=h;var u=d(t,r,n);if("normal"===u.type){if(a=n.done?m:p,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(a=m,n.method="throw",n.arg=u.arg)}}}function A(t,r){var n=r.method,a=t.iterator[n];if(a===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=d(a,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,g;var i=o.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function O(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,o=function r(){for(;++a<t.length;)if(n.call(t,a))return r.value=t[a],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(q(t)+" is not iterable")}return y.prototype=b,a(L,"constructor",{value:b,configurable:!0}),a(b,"constructor",{value:y,configurable:!0}),y.displayName=u(b,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,u(e,c,"GeneratorFunction")),e.prototype=Object.create(L),e},t.awrap=function(e){return{__await:e}},k(M.prototype),u(M.prototype,s,(function(){return this})),t.AsyncIterator=M,t.async=function(e,r,n,a,o){void 0===o&&(o=Promise);var i=new M(l(e,r,n,a),o);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},k(L),u(L,c,"Generator"),u(L,i,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=O,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(T),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function a(n,a){return s.type="throw",s.arg=t,r.next=n,a&&(r.method="next",r.arg=e),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],s=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),T(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;T(r)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:O(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function K(e,t,r,n,a,o,i){try{var s=e[o](i),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,a)}function X(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){K(o,n,a,i,s,"next",e)}function s(e){K(o,n,a,i,s,"throw",e)}i(void 0)}))}}function W(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Q(n.key),n)}}function Z(e,t,r){return t&&W(e.prototype,t),r&&W(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $(e,t,r){return(t=Q(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Q(e){var t=function(e,t){if("object"!=q(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=q(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==q(t)?t:t+""}var ee=Z((function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),$(this,"init",(function(e,r,n,a,o,i,s){t.uid=e,t.currentUser=r,t.userToChatId=n,t.currentUserPublickey=a,t.forwardMessageHandler=s,t.usersMap=i,t.ffmpeg=o,t.audioBlob=null})),$(this,"setButtonClick",(function(){document.getElementById("send-voice-button").onclick=X(z().mark((function e(){return z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==t.audioBlob||t.isVoiceRecording){e.next=3;break}return e.next=3,t.sendMessage(t.userToChatId,t.audioBlob);case 3:case"end":return e.stop()}}),e)})))})),$(this,"setVoiceRecording",(function(){var e=document.getElementById("voicechat-record-button");e.onclick=X(z().mark((function r(){var n,a,o,i,s,c,u,l,d,p,h,m,g;return z().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return(n=document.getElementById("waveform-input")).textContent="",a=f.A.create({container:n,waveColor:"rgb(200, 0, 200)",hideScrollbar:!0,autoCenter:!0,height:30,barHeight:25,barWidth:1.5,cursorWidth:0}),t.audioBlob=null,t.isVoiceRecording=!0,t.isCloseVoiceRecording=!1,o=document.getElementById("chatbox-message-input"),i=document.getElementById("send-text-button"),s=document.getElementById("send-voice-button"),c=document.getElementById("chatbox-voice-input"),u=document.getElementById("voicechat-record-time"),l=document.getElementById("voicechat-record-start"),d=document.getElementById("voicechat-record-svg-play"),p=document.getElementById("voicechat-record-svg-stop"),h=document.getElementById("voicechat-record-delete"),m=document.getElementById("voicechat-record-close"),o.classList.add("hidden"),c.classList.remove("hidden"),i.classList.add("hidden"),s.classList.remove("hidden"),a.empty(),(g=a.registerPlugin(Y.A.create({scrollingWaveform:!1,renderRecordedAudio:!1}))).on("record-end",function(){var e=X(z().mark((function e(r){var o;return z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=URL.createObjectURL(r),a.destroy(),a=f.A.create({container:n,waveColor:"rgb(200, 0, 200)",progressColor:"rgb(100, 50, 0)",hideScrollbar:!0,autoCenter:!0,height:30,barHeight:25,barWidth:1.5,cursorWidth:0,url:o}),l.onclick=function(){return a.playPause()},a.on("pause",(function(){d.classList.remove("hidden"),p.classList.add("hidden")})),a.on("play",(function(){d.classList.add("hidden"),p.classList.remove("hidden")})),a.on("timeupdate",(function(e){var t=Math.abs(a.getDuration()-e),r=Math.floor(t/60),n=Math.floor(t%60),o="0".concat(r,":").concat(n.toString().padStart(2,"0"));u.textContent=o})),a.on("finish",(function(){a.seekTo(0)})),t.audioBlob=r,t.isVoiceRecording=!1;case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),g.on("record-progress",(function(e){if(parseInt(e/1e3)>=61)l.click();else{var t=[Math.floor(e%36e5/6e4),Math.floor(e%6e4/1e3)].map((function(e){return e<10?"0"+e:e})).join(":");u.textContent=t}})),l.onclick=function(){g.stopRecording(),d.classList.remove("hidden"),p.classList.add("hidden"),h.classList.remove("hidden"),m.classList.add("hidden")},h.onclick=X(z().mark((function t(){return z().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return d.classList.add("hidden"),p.classList.remove("hidden"),h.classList.add("hidden"),m.classList.remove("hidden"),a.empty(),a.destroy(),e.click(),t.next=9,g.startRecording();case 9:case"end":return t.stop()}}),t)}))),m.onclick=function(){t.isVoiceRecording=!1,t.isCloseVoiceRecording=!0,a.empty(),a.destroy(),g.destroy(),k.unHideMediaGroup(),o.classList.remove("hidden"),c.classList.add("hidden"),i.classList.remove("hidden"),s.classList.add("hidden"),g.stopRecording()},k.hideMediaGroup(),r.next=31,g.startRecording();case 31:case"end":return r.stop()}}),r)})))})),$(this,"sendMessage",function(){var e=X(z().mark((function e(r,n){var a,o,i,s,u,l,d,f,p,h,m,g,v,y,b;return z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.audioBlob=null,a=document.getElementById("voicechat-record-delete"),o=document.getElementById("voicechat-record-close"),a.click(),o.click(),i=URL.createObjectURL(n),s=document.getElementById("chatbox"),u=k.createOutgoingMessageVoiceElement(i,Date.now(),t.timeAgo),t.userToChatId==r&&(k.chatboxScrollToBottom(!0),s.appendChild(u)),e.t0=t.ffmpeg,e.t1=Uint8Array,e.next=13,n.arrayBuffer();case 13:return e.t2=e.sent,e.t3=new e.t1(e.t2),e.next=17,e.t0.writeFile.call(e.t0,"input.webm",e.t3);case 17:return e.next=19,t.ffmpeg.exec(["-i","input.webm","-c:a","libopus","-b:a","0","output.webm"]);case 19:return e.t4=File,e.next=22,t.ffmpeg.readFile("output.webm");case 22:return e.t5=e.sent,e.t6=[e.t5],e.t7={type:"audio/webm"},l=new e.t4(e.t6,"audio.webm",e.t7),e.next=28,t.service.createAudioMessage(t.uid,l,u,k.progressSvgElementCallback);case 28:if(200!=(d=e.sent).status){e.next=44;break}return f=c.AUDIO,p=Date.now(),h=JSON.stringify({sender:t.currentUser.id,receiver:r,type:f,content:d.data,timestamp:p}),m=t.usersMap.get(r).userDetails.publickey.publickey,g=k.base64ToArrayBuffer(m),e.next=37,k.encryptMessage(t.currentUserPublickey,h);case 37:return v=e.sent,e.next=40,k.encryptMessage(g,h);case 40:return y=e.sent,b=btoa(JSON.stringify({sender:v,receiver:y})),e.next=44,t.setSendMessage(r,i,b,p,u,h);case 44:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()),$(this,"setSendMessage",function(){var e=X(z().mark((function e(r,n,a,o,i,s){var u,l,d,f,p,h;return z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=document.getElementById("chatbox"),(l=k.createOutgoingMessageVoiceElement(n,o,t.timeAgo)).setAttribute("messageData",s),l.setAttribute("lastMessageContent","You sent an audio 🔊"),l.setAttribute("currentUserId",t.currentUser.id),l.copyTextMessageCallback=t.forwardMessageHandler.copyTextMessageCallback,l.forwardMessageCallback=t.forwardMessageHandler.forwardMessageCallback,l.deleteMessageCallback=t.service.deleteMessage,t.userToChatId==r&&(k.chatboxScrollToBottom(!0),u.replaceChild(l,i)),k.reOrderLastFourChatboxElements(),k.setChatboxMessageAvatarHidden(),k.setChatboxDividerTimestamp(),k.setChatboxMessageBorderAndMargin(),e.next=15,t.service.createTextMessage(t.uid,"messages/".concat(t.currentUser.id,"/").concat(r),"".concat(t.currentUser.id,"-").concat(r),t.currentUser.id,r,c.AUDIO,a,o,!0);case 15:if(d=e.sent,f=l.querySelector(".double-check"),!d.ok){e.next=33;break}return e.next=20,d.json();case 20:p=e.sent,h=p.id,l.setAttribute("uid",t.uid),l.setAttribute("messageId",h),f.classList.remove("text-gray-500","dark:text-neutral-500"),f.classList.add("text-green-500","dark:text-green-500"),f.querySelector(".text-node").textContent="Sent",k.setUserLastMessageContent(r,"You sent an audio 🔊"),k.setUserLastMessageTimestamp(r,o),k.setUserLastMessageTimeAgo(r,o,t.timeAgo),k.reOrderUsersListIfNewMessageIsBeingSentOrReceived(r),e.next=36;break;case 33:f.classList.remove("text-gray-500","dark:text-neutral-500"),f.classList.add("text-red-500","dark:text-red-500"),f.querySelector(".text-node").textContent="Failed";case 36:case"end":return e.stop()}}),e)})));return function(t,r,n,a,o,i){return e.apply(this,arguments)}}()),this.uid=null,this.ffmpeg=null,this.currentUser=null,this.userToChatId=null,this.currentUserPublickey=null,this.forwardMessageHandler=null,this.usersMap=new Map,this.timeAgo=new B.A("en-US"),this.service=new U,this.audioBlob=null,this.isVoiceRecording=!1})),te=r(8816),re=r.n(te),ne=r(1396),ae=r.n(ne);function oe(e){return oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},oe(e)}function ie(){ie=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,a=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var o=t&&t.prototype instanceof v?t:v,i=Object.create(o.prototype),s=new S(n||[]);return a(i,"_invoke",{value:C(e,r,s)}),i}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var f="suspendedStart",p="suspendedYield",h="executing",m="completed",g={};function v(){}function y(){}function b(){}var w={};u(w,i,(function(){return this}));var x=Object.getPrototypeOf,E=x&&x(x(O([])));E&&E!==r&&n.call(E,i)&&(w=E);var L=b.prototype=v.prototype=Object.create(w);function k(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function M(e,t){function r(a,o,i,s){var c=d(e[a],e,o);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==oe(l)&&n.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,i,s)}),(function(e){r("throw",e,i,s)})):t.resolve(l).then((function(e){u.value=e,i(u)}),(function(e){return r("throw",e,i,s)}))}s(c.arg)}var o;a(this,"_invoke",{value:function(e,n){function a(){return new t((function(t,a){r(e,n,t,a)}))}return o=o?o.then(a,a):a()}})}function C(t,r,n){var a=f;return function(o,i){if(a===h)throw Error("Generator is already running");if(a===m){if("throw"===o)throw i;return{value:e,done:!0}}for(n.method=o,n.arg=i;;){var s=n.delegate;if(s){var c=A(s,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===f)throw a=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=h;var u=d(t,r,n);if("normal"===u.type){if(a=n.done?m:p,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(a=m,n.method="throw",n.arg=u.arg)}}}function A(t,r){var n=r.method,a=t.iterator[n];if(a===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=d(a,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,g;var i=o.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function O(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,o=function r(){for(;++a<t.length;)if(n.call(t,a))return r.value=t[a],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(oe(t)+" is not iterable")}return y.prototype=b,a(L,"constructor",{value:b,configurable:!0}),a(b,"constructor",{value:y,configurable:!0}),y.displayName=u(b,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,u(e,c,"GeneratorFunction")),e.prototype=Object.create(L),e},t.awrap=function(e){return{__await:e}},k(M.prototype),u(M.prototype,s,(function(){return this})),t.AsyncIterator=M,t.async=function(e,r,n,a,o){void 0===o&&(o=Promise);var i=new M(l(e,r,n,a),o);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},k(L),u(L,c,"Generator"),u(L,i,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=O,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(T),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function a(n,a){return s.type="throw",s.arg=t,r.next=n,a&&(r.method="next",r.arg=e),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],s=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),T(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;T(r)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:O(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function se(e,t,r,n,a,o,i){try{var s=e[o](i),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,a)}function ce(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){se(o,n,a,i,s,"next",e)}function s(e){se(o,n,a,i,s,"throw",e)}i(void 0)}))}}function ue(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fe(n.key),n)}}function le(e,t,r){return t&&ue(e.prototype,t),r&&ue(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function de(e,t,r){return(t=fe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fe(e){var t=function(e,t){if("object"!=oe(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=oe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==oe(t)?t:t+""}var pe=le((function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),de(this,"init",(function(e,r,n,a,o,i,s,c){t.uid=e,t.currentUser=r,t.userToChatId=n,t.currentUserPublickey=a,t.forwardMessageHandler=c,t.usersMap=s,t.viewer=o,t.ffmpeg=i,t.imagesMap=new Map})),de(this,"setButtonClick",(function(){var e=document.getElementById("chatbox-message-input"),r=document.getElementById("chatbox-voice-input"),n=document.getElementById("chatbox-image-input"),a=document.getElementById("send-text-button"),o=document.getElementById("send-voice-button"),i=document.getElementById("send-image-button");i.onclick=function(){k.isTotalImagesToSendNotExceeded(t.imagesMap.size)&&k.isImageFilesizeNotExceeded(Array.from(t.imagesMap))&&(t.imagesMap.forEach(function(){var e=ce(ie().mark((function e(r,n){var a,o,i,s,c,u,l;return ie().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.file,o=r.file.name,i=Math.floor(.75*r.width),s=Math.floor(.75*r.height),c=r.file.type,u=c.split("/")[1],l=ae().MD5(k.generateRandomString(16)).toString()+"."+u,e.next=9,t.sendMessage(t.userToChatId,a,o,i,s,c,u,l);case 9:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()),k.unHideMediaGroup(),t.imagesMap=new Map,n.innerHTML="",e.classList.remove("hidden"),r.classList.add("hidden"),n.classList.add("hidden"),a.classList.remove("hidden"),o.classList.add("hidden"),i.classList.add("hidden"))}})),de(this,"setFileInputButtonClick",(function(){document.getElementById("image-input-button").onclick=function(){document.getElementById("image-file-input").click()}})),de(this,"setFileInputOnChange",(function(){document.getElementById("image-file-input").onchange=function(){var e=ce(ie().mark((function e(r){var n,a,o,i,s,c,u,l,d;return ie().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.target.files,a=document.getElementById("chatbox-message-input"),o=document.getElementById("chatbox-voice-input"),i=document.getElementById("chatbox-image-input"),s=document.getElementById("send-text-button"),c=document.getElementById("send-voice-button"),u=document.getElementById("send-image-button"),i.innerHTML="",!n.length){e.next=23;break}k.hideMediaGroup(),a.classList.add("hidden"),o.classList.add("hidden"),i.classList.remove("hidden"),s.classList.add("hidden"),c.classList.add("hidden"),u.classList.remove("hidden"),l=ie().mark((function e(r){var l,d,f,p,h;return ie().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:l=n[r],t.imagesMap.set(r,{file:l,width:null,height:null}),(d=document.createElement("div")).style.position="relative",d.style.display="inline-block",d.style.margin="5px",(f=document.createElement("img")).setAttribute("mimeType",l.type),f.setAttribute("key",r),f.classList.add("image"),f.style.width="50px",f.style.height="50px",f.style.objectFit="fill",(p=new FileReader).onload=function(e){var n=document.createElement("img");n.src=e.target.result,n.onload=function(){t.imagesMap.set(r,{file:l,width:n.width,height:n.height})},f.src=e.target.result},p.readAsDataURL(l),(h=document.createElement("button")).innerHTML="&times;",h.style.position="absolute",h.style.top="0",h.style.right="0",h.style.backgroundColor="rgb(234 63 63)",h.style.color="white",h.style.border="none",h.style.borderRadius="50%",h.style.cursor="pointer",h.style.width="25px",h.style.height="25px",h.style.fontSize="14px",h.style.lineHeight="25px",h.style.textAlign="center",h.onclick=function(){t.imagesMap.delete(r),i.removeChild(d),t.imagesMap.size||(a.classList.remove("hidden"),o.classList.add("hidden"),i.classList.add("hidden"),s.classList.remove("hidden"),c.classList.add("hidden"),u.classList.add("hidden"))},d.appendChild(f),d.appendChild(h),i.appendChild(d);case 35:case"end":return e.stop()}}),e)})),d=0;case 18:if(!(d<n.length)){e.next=23;break}return e.delegateYield(l(d),"t0",20);case 20:d++,e.next=18;break;case 23:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()})),de(this,"sendMessage",function(){var e=ce(ie().mark((function e(r,n,a,o,i,s,u,l){var d,f,p,h,m,g,v,y,b,w,x,E,L,M,C,A=arguments;return ie().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d=A.length>8&&void 0!==A[8]&&A[8],f=null,p=URL.createObjectURL(n),!d){e.next=16;break}return e.t0=File,e.t1=Uint8Array,e.next=8,n.arrayBuffer();case 8:e.t2=e.sent,e.t3=new e.t1(e.t2),e.t4=[e.t3],e.t5=l,e.t6={type:s},f=new e.t0(e.t4,e.t5,e.t6),e.next=94;break;case 16:if("png"!=u){e.next=38;break}return e.t7=t.ffmpeg,e.t8=a,e.t9=Uint8Array,e.next=22,n.arrayBuffer();case 22:return e.t10=e.sent,e.t11=new e.t9(e.t10),e.next=26,e.t7.writeFile.call(e.t7,e.t8,e.t11);case 26:return e.next=28,t.ffmpeg.exec(["-i",a,"-vf","scale=".concat(o,":").concat(i),l]);case 28:return e.t12=File,e.next=31,t.ffmpeg.readFile(l);case 31:e.t13=e.sent,e.t14=[e.t13],e.t15=l,e.t16={type:s},f=new e.t12(e.t14,e.t15,e.t16),e.next=94;break;case 38:if("GIF"!=u){e.next=51;break}return e.t17=File,e.t18=Uint8Array,e.next=43,n.arrayBuffer();case 43:e.t19=e.sent,e.t20=new e.t18(e.t19),e.t21=[e.t20],e.t22=l,e.t23={type:s},f=new e.t17(e.t21,e.t22,e.t23),e.next=94;break;case 51:if("heic"!=u){e.next=75;break}return e.next=54,re()({blob:n,toType:"image/jpeg"});case 54:return h=e.sent,p=URL.createObjectURL(h),e.t24=t.ffmpeg,e.t25=Uint8Array,e.next=60,h.arrayBuffer();case 60:return e.t26=e.sent,e.t27=new e.t25(e.t26),e.next=64,e.t24.writeFile.call(e.t24,"input.jpeg",e.t27);case 64:return e.next=66,t.ffmpeg.exec(["-i","input.jpeg","-pix_fmt","yuv420p","-vf","scale=".concat(o,":").concat(i),"output.jpeg"]);case 66:return e.t28=File,e.next=69,t.ffmpeg.readFile("output.jpeg");case 69:e.t29=e.sent,e.t30=[e.t29],e.t31={type:"image/jpeg"},f=new e.t28(e.t30,"output.jpeg",e.t31),e.next=94;break;case 75:return e.t32=t.ffmpeg,e.t33=a,e.t34=Uint8Array,e.next=80,n.arrayBuffer();case 80:return e.t35=e.sent,e.t36=new e.t34(e.t35),e.next=84,e.t32.writeFile.call(e.t32,e.t33,e.t36);case 84:return e.next=86,t.ffmpeg.exec(["-i",a,"-pix_fmt","yuv420p","-vf","scale=".concat(o,":").concat(i),l]);case 86:return e.t37=File,e.next=89,t.ffmpeg.readFile(l);case 89:e.t38=e.sent,e.t39=[e.t38],e.t40=l,e.t41={type:s},f=new e.t37(e.t39,e.t40,e.t41);case 94:return m=document.getElementById("chatbox"),g=k.createOutgoingMessageImageElement(p,Date.now(),t.timeAgo),t.userToChatId==r&&(k.chatboxScrollToBottom(!0),m.appendChild(g)),e.next=99,t.service.createImageMessage(t.uid,f,"heic"==u?"jpeg":u,g,k.progressSvgElementCallback);case 99:if(200!=(v=e.sent).status){e.next=115;break}return y=c.IMAGE,b=Date.now(),w=JSON.stringify({sender:t.currentUser.id,receiver:r,type:y,content:v.data,timestamp:b}),x=t.usersMap.get(r).userDetails.publickey.publickey,E=k.base64ToArrayBuffer(x),e.next=108,k.encryptMessage(t.currentUserPublickey,w);case 108:return L=e.sent,e.next=111,k.encryptMessage(E,w);case 111:return M=e.sent,C=btoa(JSON.stringify({sender:L,receiver:M})),e.next=115,t.setSendMessage(r,p,C,b,g,w);case 115:case"end":return e.stop()}}),e)})));return function(t,r,n,a,o,i,s,c){return e.apply(this,arguments)}}()),de(this,"setSendMessage",function(){var e=ce(ie().mark((function e(r,n,a,o,i,s){var u,l,d,f,p,h;return ie().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=document.getElementById("chatbox"),(l=k.createOutgoingMessageImageElement(n,o,t.timeAgo)).setAttribute("messageData",s),l.setAttribute("lastMessageContent","You sent a photo 🖼️"),l.setAttribute("currentUserId",t.currentUser.id),l.copyTextMessageCallback=t.forwardMessageHandler.copyTextMessageCallback,l.forwardMessageCallback=t.forwardMessageHandler.forwardMessageCallback,l.deleteMessageCallback=t.service.deleteMessage,t.userToChatId==r&&(k.setViewerJsImageElement(l,t.viewer),k.chatboxScrollToBottom(!0),u.replaceChild(l,i)),k.reOrderLastFourChatboxElements(),k.setChatboxMessageAvatarHidden(),k.setChatboxDividerTimestamp(),k.setChatboxMessageBorderAndMargin(),e.next=15,t.service.createTextMessage(t.uid,"messages/".concat(t.currentUser.id,"/").concat(r),"".concat(t.currentUser.id,"-").concat(r),t.currentUser.id,r,c.AUDIO,a,o,!0);case 15:if(d=e.sent,f=l.querySelector(".double-check"),!d.ok){e.next=33;break}return e.next=20,d.json();case 20:p=e.sent,h=p.id,l.setAttribute("uid",t.uid),l.setAttribute("messageId",h),f.classList.remove("text-gray-500","dark:text-neutral-500"),f.classList.add("text-green-500","dark:text-green-500"),f.querySelector(".text-node").textContent="Sent",k.setUserLastMessageContent(r,"You sent a photo 🖼️"),k.setUserLastMessageTimestamp(r,o),k.setUserLastMessageTimeAgo(r,o,t.timeAgo),k.reOrderUsersListIfNewMessageIsBeingSentOrReceived(r),e.next=36;break;case 33:f.classList.remove("text-gray-500","dark:text-neutral-500"),f.classList.add("text-red-500","dark:text-red-500"),f.querySelector(".text-node").textContent="Failed";case 36:case"end":return e.stop()}}),e)})));return function(t,r,n,a,o,i){return e.apply(this,arguments)}}()),this.uid=null,this.ffmpeg=null,this.viewer=null,this.currentUser=null,this.userToChatId=null,this.currentUserPublickey=null,this.forwardMessageHandler=null,this.usersMap=new Map,this.timeAgo=new B.A("en-US"),this.service=new U,this.imagesMap=new Map}));function he(e){return he="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},he(e)}function me(){me=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,a=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var o=t&&t.prototype instanceof v?t:v,i=Object.create(o.prototype),s=new S(n||[]);return a(i,"_invoke",{value:C(e,r,s)}),i}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var f="suspendedStart",p="suspendedYield",h="executing",m="completed",g={};function v(){}function y(){}function b(){}var w={};u(w,i,(function(){return this}));var x=Object.getPrototypeOf,E=x&&x(x(O([])));E&&E!==r&&n.call(E,i)&&(w=E);var L=b.prototype=v.prototype=Object.create(w);function k(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function M(e,t){function r(a,o,i,s){var c=d(e[a],e,o);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==he(l)&&n.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,i,s)}),(function(e){r("throw",e,i,s)})):t.resolve(l).then((function(e){u.value=e,i(u)}),(function(e){return r("throw",e,i,s)}))}s(c.arg)}var o;a(this,"_invoke",{value:function(e,n){function a(){return new t((function(t,a){r(e,n,t,a)}))}return o=o?o.then(a,a):a()}})}function C(t,r,n){var a=f;return function(o,i){if(a===h)throw Error("Generator is already running");if(a===m){if("throw"===o)throw i;return{value:e,done:!0}}for(n.method=o,n.arg=i;;){var s=n.delegate;if(s){var c=A(s,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===f)throw a=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=h;var u=d(t,r,n);if("normal"===u.type){if(a=n.done?m:p,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(a=m,n.method="throw",n.arg=u.arg)}}}function A(t,r){var n=r.method,a=t.iterator[n];if(a===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=d(a,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,g;var i=o.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function O(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,o=function r(){for(;++a<t.length;)if(n.call(t,a))return r.value=t[a],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(he(t)+" is not iterable")}return y.prototype=b,a(L,"constructor",{value:b,configurable:!0}),a(b,"constructor",{value:y,configurable:!0}),y.displayName=u(b,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,u(e,c,"GeneratorFunction")),e.prototype=Object.create(L),e},t.awrap=function(e){return{__await:e}},k(M.prototype),u(M.prototype,s,(function(){return this})),t.AsyncIterator=M,t.async=function(e,r,n,a,o){void 0===o&&(o=Promise);var i=new M(l(e,r,n,a),o);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},k(L),u(L,c,"Generator"),u(L,i,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=O,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(T),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function a(n,a){return s.type="throw",s.arg=t,r.next=n,a&&(r.method="next",r.arg=e),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],s=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),T(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;T(r)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:O(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function ge(e,t,r,n,a,o,i){try{var s=e[o](i),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,a)}function ve(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){ge(o,n,a,i,s,"next",e)}function s(e){ge(o,n,a,i,s,"throw",e)}i(void 0)}))}}function ye(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xe(n.key),n)}}function be(e,t,r){return t&&ye(e.prototype,t),r&&ye(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function we(e,t,r){return(t=xe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xe(e){var t=function(e,t){if("object"!=he(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=he(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==he(t)?t:t+""}var Ee=be((function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),we(this,"init",(function(e,r,n,a){t.textMessageHandler=e,t.voiceMessageHandler=r,t.imageMessageHandler=n,t.usersMap=a})),we(this,"copyTextMessageCallback",function(){var e=ve(me().mark((function e(t){return me().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.clipboard.writeText(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),we(this,"forwardMessageCallback",(function(e,r,n,a,o){t.type=e,t.content=r,t.blob=n,t.mimeType=a,t.output=o,k.setForwardUserUiDefaults(t.usersMap)})),we(this,"setForwardMessage",(function(e){var r=document.getElementById("forward-user-svg-sent-".concat(e.id)),n=document.getElementById("forward-user-svg-default-".concat(e.id)),a=document.getElementById("forward-user-span-text-".concat(e.id)),o=document.getElementById("forward-user-button-".concat(e.id));o.onclick=ve(me().mark((function i(){return me().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(o.setAttribute("disabled",""),o.classList.add("cursor-not-allowed"),o.classList.remove("bg-indigo-600","dark:bg-indigo-300"),o.classList.add("bg-gray-600","dark:bg-gray-300"),r.classList.remove("hidden"),n.classList.add("hidden"),a.textContent="Sent",t.type!=c.TEXT){i.next=12;break}return i.next=10,t.textMessageHandler.sendMessage(e.id,t.content);case 10:case 15:i.next=20;break;case 12:if(t.type!=c.AUDIO){i.next=17;break}return i.next=15,t.voiceMessageHandler.sendMessage(e.id,t.blob);case 17:if(t.type!=c.IMAGE){i.next=20;break}return i.next=20,t.imageMessageHandler.sendMessage(e.id,t.blob,null,null,null,t.mimeType,null,t.output,!0);case 20:case"end":return i.stop()}}),i)})))})),this.type=null,this.content=null,this.blob=null,this.mimeType=null,this.output=null,this.usersMap=null,this.textMessageHandler=null,this.voiceMessageHandler=null,this.imageMessageHandler=null})),Le=r(4203),ke=r(8199),Me=r(3891),Ce=r.n(Me),Ae=r(6479),Ie=r.n(Ae),Te=r(9411);r(9308);function Se(e){return Se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Se(e)}function Oe(){Oe=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,a=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var o=t&&t.prototype instanceof v?t:v,i=Object.create(o.prototype),s=new S(n||[]);return a(i,"_invoke",{value:C(e,r,s)}),i}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var f="suspendedStart",p="suspendedYield",h="executing",m="completed",g={};function v(){}function y(){}function b(){}var w={};u(w,i,(function(){return this}));var x=Object.getPrototypeOf,E=x&&x(x(O([])));E&&E!==r&&n.call(E,i)&&(w=E);var L=b.prototype=v.prototype=Object.create(w);function k(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function M(e,t){function r(a,o,i,s){var c=d(e[a],e,o);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==Se(l)&&n.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,i,s)}),(function(e){r("throw",e,i,s)})):t.resolve(l).then((function(e){u.value=e,i(u)}),(function(e){return r("throw",e,i,s)}))}s(c.arg)}var o;a(this,"_invoke",{value:function(e,n){function a(){return new t((function(t,a){r(e,n,t,a)}))}return o=o?o.then(a,a):a()}})}function C(t,r,n){var a=f;return function(o,i){if(a===h)throw Error("Generator is already running");if(a===m){if("throw"===o)throw i;return{value:e,done:!0}}for(n.method=o,n.arg=i;;){var s=n.delegate;if(s){var c=A(s,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===f)throw a=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=h;var u=d(t,r,n);if("normal"===u.type){if(a=n.done?m:p,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(a=m,n.method="throw",n.arg=u.arg)}}}function A(t,r){var n=r.method,a=t.iterator[n];if(a===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=d(a,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,g;var i=o.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function O(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,o=function r(){for(;++a<t.length;)if(n.call(t,a))return r.value=t[a],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(Se(t)+" is not iterable")}return y.prototype=b,a(L,"constructor",{value:b,configurable:!0}),a(b,"constructor",{value:y,configurable:!0}),y.displayName=u(b,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,u(e,c,"GeneratorFunction")),e.prototype=Object.create(L),e},t.awrap=function(e){return{__await:e}},k(M.prototype),u(M.prototype,s,(function(){return this})),t.AsyncIterator=M,t.async=function(e,r,n,a,o){void 0===o&&(o=Promise);var i=new M(l(e,r,n,a),o);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},k(L),u(L,c,"Generator"),u(L,i,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=O,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(T),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function a(n,a){return s.type="throw",s.arg=t,r.next=n,a&&(r.method="next",r.arg=e),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],s=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),T(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;T(r)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:O(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function je(e,t,r,n,a,o,i){try{var s=e[o](i),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,a)}function Pe(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){je(o,n,a,i,s,"next",e)}function s(e){je(o,n,a,i,s,"throw",e)}i(void 0)}))}}function Ue(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ge(n.key),n)}}function Be(e,t,r){return t=Ne(t),function(e,t){if(t&&("object"==Se(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,_e()?Reflect.construct(t,r||[],Ne(e).constructor):t.apply(e,r))}function _e(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(_e=function(){return!!e})()}function Ne(e){return Ne=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ne(e)}function De(e,t){return De=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},De(e,t)}function Fe(e,t,r){return(t=Ge(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ge(e){var t=function(e,t){if("object"!=Se(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Se(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Se(t)?t:t+""}var He=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];return Fe(e=Be(this,t,[].concat(n)),"connect",Pe(Oe().mark((function t(){var r,n;return Oe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return B.A.addDefaultLocale(Te.A),Ie().logToConsole=!1,e.pusher=new(Ie())("7c4d952c51d2be9a8302",{cluster:"ap1",authEndpoint:"/pusher_auth",auth:{params:{uid:e.uidValue}}}),e.page=1,e.pageSize=20,e.service=new U,e.timeAgo=new B.A("en-US"),e.textMessageHandler=new J,e.voiceMessageHandler=new ee,e.imageMessageHandler=new pe,e.forwardMessageHandler=new Ee,e.isReceivedFirstMessage=!1,e.isLockInfiniteScrolling=!1,e.usersOnlineMap=new Map,e.usersMap=new Map,e.toSendImagesMap=new Map,e.ffmpeg=new Le.m,e.viewer=new(Ce())(document.getElementById("viewerjs-images-container")),e.isTyping=!1,e.typingTimeout=null,t.t0=e.ffmpeg,t.next=23,(0,ke.KA)("/ffmpeg-core.js","text/javascript");case 23:return t.t1=t.sent,t.next=26,(0,ke.KA)("/ffmpeg-core.wasm","application/wasm");case 26:return t.t2=t.sent,t.t3={coreURL:t.t1,wasmURL:t.t2},t.next=30,t.t0.load.call(t.t0,t.t3);case 30:return t.next=32,e.service.getUsers(e.uidValue);case 32:if(!(r=t.sent).ok){t.next=58;break}return t.next=36,r.json();case 36:return n=t.sent,e.setDarkModeToggle(),e.setEmojiPickerElement(),e.setUserPusherPresenceChannel(),e.setUserProfileInputAvatar(),e.setChatboxEventListener(),e.setIsTypingNotification(),e.setSidebarMenus(),e.textMessageHandler.setButtonClick(),e.textMessageHandler.setInputKeyDown(),e.voiceMessageHandler.setButtonClick(),e.voiceMessageHandler.setVoiceRecording(),e.imageMessageHandler.setButtonClick(),e.imageMessageHandler.setFileInputOnChange(),e.imageMessageHandler.setFileInputButtonClick(),n.forEach(function(){var t=Pe(Oe().mark((function t(r){return Oe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.usersMap.set(r.id,r),e.forwardMessageHandler.setForwardMessage(r),e.setUserPusherMessagesChannel(r),e.setUserPusherIsTypingChannel(r),e.setUserPusherDeleteMessageChannel(r),t.next=7,e.setSidebarUserClickEvent(r);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),t.next=54,e.setEncryptionDetails();case 54:return t.next=56,e.setUserLastMessage();case 56:return t.next=58,e.setChatboxInfiniteScrolling();case 58:case"end":return t.stop()}}),t)})))),Fe(e,"setEncryptionDetails",Pe(Oe().mark((function t(){var r,n,a,o,i;return Oe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.passphraseValue){t.next=13;break}return r=ae().lib.WordArray.random(16),n=r.toString(ae().enc.Hex),t.next=5,k.generateEncryptionKeyPair();case 5:return a=t.sent,o=k.arrayBufferToBase64(a.publicKey),i=ae().AES.encrypt(k.arrayBufferToBase64(a.privateKey),n),t.next=10,e.service.setEncryptionDetails(e.uidValue,o,i,n);case 10:window.location.href="/",t.next=15;break;case 13:e.currentUserPublickey=k.base64ToArrayBuffer(e.publickeyValue),e.currentUserPrivatekey=k.base64ToArrayBuffer(ae().AES.decrypt(e.privatekeyValue,e.passphraseValue).toString(ae().enc.Utf8));case 15:case"end":return t.stop()}}),t)})))),Fe(e,"setUserPusherMessagesChannel",(function(t){var r=document.getElementById("chatbox");e.pusher.subscribe("".concat(t.id,"-").concat(e.currentUserValue.id)).bind("messages/".concat(t.id,"/").concat(e.currentUserValue.id),function(){var n=Pe(Oe().mark((function n(a){var o,i,s,u,l,d,f,p,h,m;return Oe().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=a.id,i=a.content,a.isSeen,s=JSON.parse(atob(i)),s.sender,u=s.receiver,n.t0=JSON,n.next=5,k.decryptMessage(e.currentUserPrivatekey,u);case 5:n.t1=n.sent,(l=n.t0.parse.call(n.t0,n.t1)).sender==e.userToChatId&&(d=null,l.type==c.TEXT?(d=k.createIncomingMessageTextElement(l.content,t.userDetails.avatar,l.timestamp,e.timeAgo)).setAttribute("lastMessageContent",l.content):l.type==c.AUDIO?(d=k.createIncomingMessageVoiceElement(l.content,t.userDetails.avatar,l.timestamp,e.timeAgo),f=e.usersMap.get(l.sender).userDetails.firstname.split(" ")[0],d.setAttribute("lastMessageContent",f+" sent an audio 🔊")):l.type==c.IMAGE&&(d=k.createIncommingMessageImageElement(l.content,t.userDetails.avatar,l.timestamp,e.timeAgo),p=e.usersMap.get(l.sender).userDetails.firstname.split(" ")[0],d.setAttribute("lastMessageContent",p+" sent a photo 🖼️"),k.setViewerJsImageElement(d,e.viewer)),e.setMessageElementAttribute(d,o,l),k.chatboxScrollToBottom(),r.appendChild(d),k.reOrderLastFourChatboxElements(),k.setChatboxMessageAvatarHidden(),k.setChatboxDividerTimestamp(),k.setChatboxMessageBorderAndMargin()),l.type==c.TEXT?k.setUserLastMessageContent(l.sender,l.content):l.type==c.AUDIO?(h=e.usersMap.get(l.sender).userDetails.firstname.split(" ")[0],k.setUserLastMessageContent(l.sender,h+" sent an audio 🔊")):l.type==c.IMAGE&&(m=e.usersMap.get(l.sender).userDetails.firstname.split(" ")[0],k.setUserLastMessageContent(l.sender,m+" sent a photo 🖼️")),k.setUserLastMessageTimestamp(l.sender,l.timestamp),k.setUserLastMessageTimeAgo(l.sender,l.timestamp,e.timeAgo),k.reOrderUsersListIfNewMessageIsBeingSentOrReceived(l.sender);case 12:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())})),Fe(e,"setUserPusherIsTypingChannel",(function(t){var r=document.getElementById("chatbox"),n=e.usersMap.get(t.id).userDetails.avatar,a=e.pusher.subscribe("".concat(t.id,"-").concat(e.currentUserValue.id)),o=k.createIncomingIsTypingElement(n),i=document.getElementById("user".concat(t.id,"-last-message")),s=i.textContent;a.bind("typing/".concat(t.id,"/").concat(e.currentUserValue.id),function(){var n=Pe(Oe().mark((function n(a){return Oe().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t.id==e.userToChatId)if("true"==a)r.appendChild(o),k.chatboxScrollToBottom();else try{r.removeChild(o)}catch(e){}"true"==a?(s=i.textContent,i.classList.add("is-typing-loader","w-10"),i.textContent=""):(i.classList.remove("is-typing-loader","w-10"),i.textContent||(i.textContent=s));case 2:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())})),Fe(e,"setUserPusherDeleteMessageChannel",(function(t){var r=document.getElementById("chatbox");e.pusher.subscribe("".concat(t.id,"-").concat(e.currentUserValue.id)).bind("delete_message-".concat(t.id,"-").concat(e.currentUserValue.id),function(){var n=Pe(Oe().mark((function n(a){var o,i,s,c,u,l,d,f,p,h,m;return Oe().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.userToChatId!=t.id){n.next=31;break}o=a,i=null,s=r.children.length-1;case 4:if(!(s>=0)){n.next=15;break}if(c=r.children[s],i=c,!c.getAttribute("messageId")){n.next=12;break}if(u=c.getAttribute("messageId"),o!=u){n.next=12;break}return r.removeChild(c),n.abrupt("break",15);case 12:s--,n.next=4;break;case 15:k.chatboxScrollToBottom(),k.reOrderLastFourChatboxElements(),k.setChatboxMessageAvatarHidden(),k.setChatboxDividerTimestamp(),k.setChatboxMessageBorderAndMargin(),l=null,s=r.children.length-1;case 22:if(!(s>=0)){n.next=29;break}if(!(l=r.children[s]).getAttribute("lastMessageContent")){n.next=26;break}return n.abrupt("break",29);case 26:s--,n.next=22;break;case 29:l.getAttribute("lastMessageContent")?(d=l.getAttribute("currentUserId"),f=l.getAttribute("lastMessageContent"),p=JSON.parse(l.getAttribute("messageData")),h=p.sender,d==p.sender&&(h=p.receiver),k.setUserLastMessageContent(h,f),k.setUserLastMessageTimestamp(h,p.timestamp),k.setUserLastMessageTimeAgo(h,p.timestamp,e.timeAgo),k.reOrderUsersListIfNewMessageIsBeingSentOrReceived(h)):(m=JSON.parse(i.getAttribute("messageData")),k.setUserLastMessageContent(m.receiver,"..."),k.setUserLastMessageTimestamp(m.receiver,1),k.reOrderUsersListIfNewMessageIsBeingSentOrReceived(m.receiver)),k.sortUsersListBaseOnLastMessageTimestamp();case 31:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())})),Fe(e,"setUserPusherPresenceChannel",(function(){var t=e,r=e.pusher.subscribe("presence-online-users");r.bind("pusher:subscription_succeeded",(function(e){e.each((function(e){var r=e.info.id,n=document.getElementById("user".concat(r,"-online-status"));n.classList.remove("bg-red-400"),n.classList.add("bg-green-400"),t.usersOnlineMap.set(r,!0)}))})),r.bind("pusher:member_added",(function(e){var r=e.info.id,n=document.getElementById("user".concat(r,"-online-status"));if(n.classList.remove("bg-red-400"),n.classList.add("bg-green-400"),r==t.userToChatId){var a=document.getElementById("usertochat-online-status"),o=document.getElementById("usertochat-online-text");a.classList.remove("bg-red-400"),a.classList.add("bg-green-400"),o.textContent="Active now"}t.usersOnlineMap.set(r,!0)})),r.bind("pusher:member_removed",(function(e){var r=e.info.id,n=document.getElementById("user".concat(r,"-online-status"));if(n.classList.add("bg-red-400"),n.classList.remove("bg-green-400"),r==t.userToChatId){var a=document.getElementById("usertochat-online-status"),o=document.getElementById("usertochat-online-text");a.classList.remove("bg-green-400"),a.classList.add("bg-red-400"),o.textContent="Offline"}t.usersOnlineMap.set(r,!1)}))})),Fe(e,"setUserLastMessage",Pe(Oe().mark((function t(){var r,n,a,o,i,s,u,l,d,f,p,h;return Oe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.service.getLastMessages(e.uidValue,e.currentUserValue.id);case 2:if(!(r=t.sent).ok){t.next=40;break}return t.next=6,r.json();case 6:n=t.sent,a=0;case 8:if(!(a<n.length)){t.next=40;break}return o=n[a],o.id,i=o.content,o.isSeen,s=JSON.parse(atob(i)),u=s.sender,l=s.receiver,t.prev=11,t.t0=JSON,t.next=15,k.decryptMessage(e.currentUserPrivatekey,u);case 15:t.t1=t.sent,(d=t.t0.parse.call(t.t0,t.t1)).type==c.TEXT?k.setUserLastMessageContent(d.receiver,d.content):d.type==c.AUDIO?k.setUserLastMessageContent(d.receiver,"You sent an audio 🔊"):d.type==c.IMAGE&&k.setUserLastMessageContent(d.receiver,"You sent a photo 🖼️"),k.setUserLastMessageTimestamp(d.receiver,d.timestamp),k.setUserLastMessageTimeAgo(d.receiver,d.timestamp,e.timeAgo),t.next=37;break;case 22:return t.prev=22,t.t2=t.catch(11),t.prev=24,t.t3=JSON,t.next=28,k.decryptMessage(e.currentUserPrivatekey,l);case 28:t.t4=t.sent,(f=t.t3.parse.call(t.t3,t.t4)).type==c.TEXT?k.setUserLastMessageContent(f.sender,f.content):f.type==c.AUDIO?(p=e.usersMap.get(f.sender).userDetails.firstname.split(" ")[0],k.setUserLastMessageContent(f.sender,p+" sent an audio 🔊")):f.type==c.IMAGE&&(h=e.usersMap.get(f.sender).userDetails.firstname.split(" ")[0],k.setUserLastMessageContent(f.sender,h+" sent a photo 🖼️")),k.setUserLastMessageTimestamp(f.sender,f.timestamp),k.setUserLastMessageTimeAgo(f.sender,f.timestamp,e.timeAgo),t.next=37;break;case 35:t.prev=35,t.t5=t.catch(24);case 37:a++,t.next=8;break;case 40:k.sortUsersListBaseOnLastMessageTimestamp();case 41:case"end":return t.stop()}}),t,null,[[11,22],[24,35]])})))),Fe(e,"setUserProfileInputAvatar",(function(){var t=document.getElementById("user_profile_form_avatar"),r=document.getElementById("user-profile-preview");t.onchange=function(){var n=Pe(Oe().mark((function n(a){var o,i,s;return Oe().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:o=a.target.files,(i=o[0])&&((s=new FileReader).readAsDataURL(i),s.onload=function(){var n=Pe(Oe().mark((function n(a){var o;return Oe().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:(o=document.createElement("img")).src=a.target.result,o.onload=Pe(Oe().mark((function n(){var a,s,c,u,l,d,f,p,h;return Oe().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a=Math.floor(.75*o.width),s=Math.floor(.75*o.height),c=i.type,u=c.split("/")[1],l=i.name,d=ae().MD5(k.generateRandomString(16)).toString()+"."+u,e.currentUserValue.userDetails.badge){n.next=11;break}if("gif"!=u.toLowerCase()){n.next=11;break}return f=new DataTransfer,t.files=f.files,n.abrupt("return");case 11:return n.t0=e.ffmpeg,n.t1=l,n.t2=Uint8Array,n.next=16,i.arrayBuffer();case 16:return n.t3=n.sent,n.t4=new n.t2(n.t3),n.next=20,n.t0.writeFile.call(n.t0,n.t1,n.t4);case 20:return n.next=22,e.ffmpeg.exec(["-i",l,"-vf","scale=".concat(a,":").concat(s),d]);case 22:return n.t5=File,n.next=25,e.ffmpeg.readFile(d);case 25:n.t6=n.sent,n.t7=[n.t6],n.t8=d,n.t9={type:c},i=new n.t5(n.t7,n.t8,n.t9),(p=new DataTransfer).items.add(i),t.files=p.files,h=URL.createObjectURL(i),r.textContent="",r.style.backgroundImage="url('".concat(h,"')"),r.style.backgroundSize="contain",r.style.backgroundPosition="center",r.style.backgroundRepeat="no-repeat",r.style.width="100%",r.style.height="100%";case 41:case"end":return n.stop()}}),n)})));case 3:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}());case 3:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()})),Fe(e,"setSidebarUserClickEvent",function(){var t=Pe(Oe().mark((function t(r){return Oe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return document.getElementById("user".concat(r.id)).onclick=Pe(Oe().mark((function t(){var n,a,o,i,s;return Oe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n="".concat(r.userDetails.firstname," ").concat(r.userDetails.lastname),a=r.userDetails.badge,o=r.userDetails.badgecolor,i=r.userDetails.avatar,s=r.userDetails.publickey.publickey,e.userTochatPublickey=k.base64ToArrayBuffer(s),e.userToChatId=r.id,e.isSidebarUserClickOnce=!0,e.setUserToChatName(n),e.setUserToChatAvatar(i),e.setUserToChatBadge(a,o),e.setSidebarUserToggleForMobile(),e.setMainChatbox(),e.setDefaultValues(),t.next=16,e.setConversations();case 16:e.setUserToChatOnlineStatus(),e.textMessageHandler.init(e.uidValue,e.currentUserValue,r.id,e.currentUserPublickey,e.usersMap,e.forwardMessageHandler),e.voiceMessageHandler.init(e.uidValue,e.currentUserValue,r.id,e.currentUserPublickey,e.ffmpeg,e.usersMap,e.forwardMessageHandler),e.imageMessageHandler.init(e.uidValue,e.currentUserValue,r.id,e.currentUserPublickey,e.viewer,e.ffmpeg,e.usersMap,e.forwardMessageHandler),e.forwardMessageHandler.init(e.textMessageHandler,e.voiceMessageHandler,e.imageMessageHandler,e.usersMap);case 21:case"end":return t.stop()}}),t)}))),t.next=4,k.sleep(1);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),Fe(e,"setIsTypingNotification",(function(){var t=document.getElementById("chatbox-message-input");t.addEventListener("keydown",Pe(Oe().mark((function t(){var r;return Oe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.usersOnlineMap.get(e.userToChatId),e.isTyping){t.next=6;break}if(e.isTyping=!0,!r){t.next=6;break}return t.next=6,e.service.sendTypingNotification(e.uidValue,"typing/".concat(e.currentUserValue.id,"/").concat(e.userToChatId),"".concat(e.currentUserValue.id,"-").concat(e.userToChatId),!0);case 6:clearTimeout(e.typingTimeout),e.typingTimeout=setTimeout(Pe(Oe().mark((function t(){return Oe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.isTyping=!1,!r){t.next=4;break}return t.next=4,e.service.sendTypingNotification(e.uidValue,"typing/".concat(e.currentUserValue.id,"/").concat(e.userToChatId),"".concat(e.currentUserValue.id,"-").concat(e.userToChatId),!1);case 4:case"end":return t.stop()}}),t)}))),1e3);case 8:case"end":return t.stop()}}),t)})))),t.addEventListener("blur",Pe(Oe().mark((function t(){var r;return Oe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.usersOnlineMap.get(e.userToChatId),e.isTyping=!1,!r){t.next=5;break}return t.next=5,e.service.sendTypingNotification(e.uidValue,"typing/".concat(e.currentUserValue.id,"/").concat(e.userToChatId),"".concat(e.currentUserValue.id,"-").concat(e.userToChatId),!1);case 5:case"end":return t.stop()}}),t)}))))})),Fe(e,"setChatboxEventListener",(function(){var e=document.getElementById("chatbox-message-input");e.onblur=function(){k.unHideMediaGroup()},e.onfocus=function(){k.hideMediaGroup()}})),Fe(e,"setChatboxInfiniteScrolling",Pe(Oe().mark((function t(){var r;return Oe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(r=document.getElementById("chatbox")).onscroll=Pe(Oe().mark((function t(){var n,a,o,i,s,u,l,d,f,p,h,m,g,v,y,b,w;return Oe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0!=r.scrollTop||e.isReceivedFirstMessage||e.isLockInfiniteScrolling){t.next=66;break}e.page+=1,e.isLockInfiniteScrolling=!0,n=r.removeChild(r.children[0]),a=0,o=null;case 7:if(!(a<r.children.length)){t.next=14;break}if((o=r.children[a]).classList.contains("divider-timestamp")){t.next=11;break}return t.abrupt("break",14);case 11:a++,t.next=7;break;case 14:return i=k.createLoaderElement(),r.prepend(i),t.next=18,e.service.getMessages(e.uidValue,e.currentUserValue.id,e.userToChatId,e.page,e.pageSize,1);case 18:if(!(s=t.sent).ok){t.next=64;break}return t.next=22,s.json();case 22:if(u=t.sent,r.removeChild(i),!u.length){t.next=63;break}l=0;case 26:if(!(l<u.length)){t.next=57;break}return d=u[l],f=d.id,p=d.content,d.isSeen,h=JSON.parse(atob(p)),m=h.sender,g=h.receiver,t.prev=29,v=null,t.t0=JSON,t.next=34,k.decryptMessage(e.currentUserPrivatekey,m);case 34:t.t1=t.sent,(y=t.t0.parse.call(t.t0,t.t1)).type==c.TEXT?v=k.createOutgoingMessageTextElement(y.content,y.timestamp,e.timeAgo):y.type==c.AUDIO?v=k.createOutgoingMessageVoiceElement(y.content,y.timestamp,e.timeAgo):y.type==c.IMAGE&&(v=k.createOutgoingMessageImageElement(y.content,y.timestamp,e.timeAgo),k.setViewerJsImageElement(v,e.viewer)),e.setMessageElementAttribute(v,f,y),r.prepend(v),v.querySelector(".double-check").classList.add("hidden"),t.next=54;break;case 43:return t.prev=43,t.t2=t.catch(29),b=null,t.t3=JSON,t.next=49,k.decryptMessage(e.currentUserPrivatekey,g);case 49:t.t4=t.sent,(w=t.t3.parse.call(t.t3,t.t4)).type==c.TEXT?b=k.createIncomingMessageTextElement(w.content,e.usersMap.get(w.sender).userDetails.avatar,w.timestamp,e.timeAgo):w.type==c.AUDIO?b=k.createIncomingMessageVoiceElement(w.content,e.usersMap.get(w.sender).userDetails.avatar,w.timestamp,e.timeAgo):w.type==c.IMAGE&&(b=k.createIncommingMessageImageElement(w.content,e.usersMap.get(w.sender).userDetails.avatar,w.timestamp,e.timeAgo),k.setViewerJsImageElement(b,e.viewer)),e.setMessageElementAttribute(b,f,w),r.prepend(b);case 54:l++,t.next=26;break;case 57:k.setChatboxMessageAvatarHidden(),k.setChatboxDividerTimestamp(),k.setChatboxMessageBorderAndMargin(),setTimeout((function(){o.scrollIntoView({behavior:"smooth",block:"end"}),r.prepend(n),e.isLockInfiniteScrolling=!1}),500),t.next=64;break;case 63:e.isReceivedFirstMessage=!0;case 64:t.next=67;break;case 66:e.isSidebarUserClickOnce=!1;case 67:case"end":return t.stop()}}),t,null,[[29,43]])}))),t.next=4,k.sleep(1);case 4:case"end":return t.stop()}}),t)})))),Fe(e,"setDefaultValues",(function(){e.page=1,e.isReceivedFirstMessage=!1,e.isLockInfiniteScrolling=!0,document.getElementById("viewerjs-images-container").innerHTML=""})),Fe(e,"setConversations",Pe(Oe().mark((function t(){var r,n,a,o,i,s,u,l,d,f,p,h,m,g,v,y,b,w,x,E,L,M;return Oe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=function(){var e=document.getElementById("chatbox"),t=document.createElement("div");t.className="flex flex-grow",e.innerHTML="",e.append(t)},r(),n=document.getElementById("chatbox"),a=k.createLoaderElement(),n.appendChild(a),o=!1,t.next=8,e.service.getMessages(e.uidValue,e.currentUserValue.id,e.userToChatId,e.page,e.pageSize);case 8:if(!(i=t.sent).ok){t.next=47;break}return t.next=12,i.json();case 12:s=t.sent,u=0;case 14:if(!(u<s.length)){t.next=45;break}return l=s[u],d=l.id,f=l.content,l.isSeen,p=JSON.parse(atob(f)),h=p.sender,m=p.receiver,t.prev=17,g=null,t.t0=JSON,t.next=22,k.decryptMessage(e.currentUserPrivatekey,h);case 22:t.t1=t.sent,(v=t.t0.parse.call(t.t0,t.t1)).type==c.TEXT?(g=k.createOutgoingMessageTextElement(v.content,v.timestamp,e.timeAgo)).setAttribute("lastMessageContent",v.content):v.type==c.AUDIO?(g=k.createOutgoingMessageVoiceElement(v.content,v.timestamp,e.timeAgo)).setAttribute("lastMessageContent","You sent an audio 🔊"):v.type==c.IMAGE&&((g=k.createOutgoingMessageImageElement(v.content,v.timestamp,e.timeAgo)).setAttribute("lastMessageContent","You sent a photo 🖼️"),k.setViewerJsImageElement(g,e.viewer)),e.setMessageElementAttribute(g,d,v),n.appendChild(g),g.querySelector(".double-check").classList.add("hidden"),t.next=42;break;case 31:return t.prev=31,t.t2=t.catch(17),y=null,t.t3=JSON,t.next=37,k.decryptMessage(e.currentUserPrivatekey,m);case 37:t.t4=t.sent,(b=t.t3.parse.call(t.t3,t.t4)).type==c.TEXT?(y=k.createIncomingMessageTextElement(b.content,e.usersMap.get(b.sender).userDetails.avatar,b.timestamp,e.timeAgo)).setAttribute("lastMessageContent",b.content):b.type==c.AUDIO?(y=k.createIncomingMessageVoiceElement(b.content,e.usersMap.get(b.sender).userDetails.avatar,b.timestamp,e.timeAgo),w=e.usersMap.get(b.sender).userDetails.firstname.split(" ")[0],y.setAttribute("lastMessageContent",w+" sent an audio 🔊")):b.type==c.IMAGE&&(y=k.createIncommingMessageImageElement(b.content,e.usersMap.get(b.sender).userDetails.avatar,b.timestamp,e.timeAgo),x=e.usersMap.get(b.sender).userDetails.firstname.split(" ")[0],y.setAttribute("lastMessageContent",x+" sent a photo 🖼️"),k.setViewerJsImageElement(y,e.viewer)),e.setMessageElementAttribute(y,d,b),n.appendChild(y);case 42:u++,t.next=14;break;case 45:k.chatboxScrollToBottom(!0),o=!!s.length;case 47:e.isLockInfiniteScrolling=!1,n.removeChild(a),k.setChatboxMessageAvatarHidden(),k.setChatboxDividerTimestamp(),k.setChatboxMessageBorderAndMargin(),o||(E=e.usersMap.get(e.userToChatId),L="".concat(E.userDetails.firstname," ").concat(E.userDetails.lastname),M=E.userDetails.avatar,k.setIntroductionElement(L,M));case 53:case"end":return t.stop()}}),t,null,[[17,31]])})))),Fe(e,"setUserToChatName",(function(e){document.getElementById("user-to-chat-name").textContent=e})),Fe(e,"setUserToChatAvatar",(function(e){document.getElementById("usertochat-avatar").style.backgroundImage="url('".concat(e,"')")})),Fe(e,"setSidebarMenus",(function(){var e=document.getElementById("chats-menu-li"),t=document.getElementById("contacts-menu-li"),r=document.getElementById("profile-menu-li"),n=document.getElementById("calls-menu-li"),a=document.getElementById("settings-menu-li"),o=document.getElementById("chats-menu-div"),i=document.getElementById("contacts-menu-div"),s=document.getElementById("calls-menu-div"),c=document.getElementById("settings-menu-div"),u=document.getElementById("menu-text-p");e.onclick=function(){u.textContent="Recent chats",e.classList.add("text-indigo-400"),e.classList.remove("text-gray-400"),t.classList.remove("text-indigo-400"),r.classList.remove("text-indigo-400"),n.classList.remove("text-indigo-400"),a.classList.remove("text-indigo-400"),t.classList.add("text-gray-400"),r.classList.add("text-gray-400"),n.classList.add("text-gray-400"),a.classList.add("text-gray-400"),o.classList.remove("hidden"),i.classList.add("hidden"),s.classList.add("hidden"),c.classList.add("hidden")},t.onclick=function(){u.textContent="Contacts",t.classList.add("text-indigo-400"),t.classList.remove("text-gray-400"),e.classList.remove("text-indigo-400"),r.classList.remove("text-indigo-400"),n.classList.remove("text-indigo-400"),a.classList.remove("text-indigo-400"),e.classList.add("text-gray-400"),r.classList.add("text-gray-400"),n.classList.add("text-gray-400"),a.classList.add("text-gray-400"),o.classList.add("hidden"),i.classList.remove("hidden"),s.classList.add("hidden"),c.classList.add("hidden")},r.onclick=function(){},n.onclick=function(){u.textContent="Calls",n.classList.add("text-indigo-400"),n.classList.remove("text-gray-400"),e.classList.remove("text-indigo-400"),t.classList.remove("text-indigo-400"),r.classList.remove("text-indigo-400"),a.classList.remove("text-indigo-400"),e.classList.add("text-gray-400"),t.classList.add("text-gray-400"),r.classList.add("text-gray-400"),a.classList.add("text-gray-400"),o.classList.add("hidden"),i.classList.add("hidden"),s.classList.remove("hidden"),c.classList.add("hidden")},a.onclick=function(){u.textContent="Settings",a.classList.add("text-indigo-400"),a.classList.remove("text-gray-400"),e.classList.remove("text-indigo-400"),t.classList.remove("text-indigo-400"),r.classList.remove("text-indigo-400"),n.classList.remove("text-indigo-400"),e.classList.add("text-gray-400"),t.classList.add("text-gray-400"),r.classList.add("text-gray-400"),n.classList.add("text-gray-400"),o.classList.add("hidden"),i.classList.add("hidden"),s.classList.add("hidden"),c.classList.remove("hidden")}})),Fe(e,"setUserToChatBadge",(function(e,t){var r=document.getElementById("user-to-chat-badge");e?(r.classList.remove("hidden"),r.classList.add("text-".concat(t,"-600"))):(r.classList.add("hidden"),r.classList.remove("text-".concat(t,"-600")))})),Fe(e,"setUserToChatOnlineStatus",(function(){var t=e.usersOnlineMap.get(e.userToChatId),r=document.getElementById("usertochat-online-status"),n=document.getElementById("usertochat-online-text");t?(r.classList.remove("bg-red-400"),r.classList.add("bg-green-400"),n.textContent="Active now"):(r.classList.add("bg-red-400"),r.classList.remove("bg-green-400"),setTimeout(Pe(Oe().mark((function t(){return Oe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.setUserLastSeen(n);case 2:case"end":return t.stop()}}),t)}))),1))})),Fe(e,"setUserLastSeen",function(){var t=Pe(Oe().mark((function t(r){var n,a;return Oe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r.textContent="Offline",t.next=3,e.service.getUserLastSeen(e.uidValue,e.userToChatId);case 3:if(!(n=t.sent).ok){t.next=9;break}return t.next=7,n.json();case 7:a=t.sent,r.textContent="Last seen "+e.timeAgo.format(parseInt(a.timestamp),"round");case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),Fe(e,"setMessageElementAttribute",(function(t,r,n){t.setAttribute("uid",e.uidValue),t.setAttribute("messageId",r),t.setAttribute("messageData",JSON.stringify(n)),t.setAttribute("currentUserId",e.currentUserValue.id),t.copyTextMessageCallback=e.forwardMessageHandler.copyTextMessageCallback,t.forwardMessageCallback=e.forwardMessageHandler.forwardMessageCallback,t.deleteMessageCallback=e.service.deleteMessage})),Fe(e,"setDarkModeToggle",(function(){var e=document.getElementById("theme-toggle-dark-icon"),t=document.getElementById("theme-toggle-light-icon"),r=document.querySelector(".emoji-picker"),n=document.getElementById("theme-toggle-input");n.onchange=function(e){e.target.checked?(document.documentElement.classList.add("dark"),localStorage.setItem("color-theme","dark"),r.classList.remove("light"),r.classList.add("dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("color-theme","light"),r.classList.add("light"),r.classList.remove("dark"))},"dark"===localStorage.getItem("color-theme")||!("color-theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?(t.classList.remove("hidden"),document.documentElement.classList.add("dark"),r.classList.remove("light"),r.classList.add("dark"),n.checked=!0):(e.classList.remove("hidden"),document.documentElement.classList.remove("dark"),r.classList.add("light"),r.classList.remove("dark"),n.checked=!1),document.getElementById("theme-toggle").onclick=function(){e.classList.toggle("hidden"),t.classList.toggle("hidden"),localStorage.getItem("color-theme")?"light"===localStorage.getItem("color-theme")?(document.documentElement.classList.add("dark"),localStorage.setItem("color-theme","dark"),r.classList.remove("light"),r.classList.add("dark"),n.checked=!0):(document.documentElement.classList.remove("dark"),localStorage.setItem("color-theme","light"),r.classList.add("light"),r.classList.remove("dark"),n.checked=!1):document.documentElement.classList.contains("dark")?(document.documentElement.classList.remove("dark"),localStorage.setItem("color-theme","light")):(document.documentElement.classList.add("dark"),localStorage.setItem("color-theme","dark"))}})),Fe(e,"setEmojiPickerElement",(function(){var e=document.getElementById("chatbox-message-input");document.querySelector("emoji-picker").addEventListener("emoji-click",(function(t){var r=k.saveCaretPosition(e);e.innerHTML=e.innerHTML.substring(0,r)+t.detail.unicode+e.innerHTML.substring(r),k.restoreCaretPosition(e,r+t.detail.unicode.length)}))})),Fe(e,"setSidebarUserToggleForMobile",(function(){"mobile"==k.getUserAgentPlatformType()&&setTimeout((function(){document.getElementById("separator-sidebar-button").click()}),200)})),Fe(e,"setMainChatbox",(function(){var e=document.getElementById("main-chatbox"),t=document.getElementById("main-chatbox-intro");e.classList.remove("hidden"),t.classList.add("hidden")})),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&De(e,t)}(t,e),r=t,n&&Ue(r.prototype,n),a&&Ue(r,a),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,a}(n.xI);Fe(He,"values",{currentUser:Object,uid:String,publickey:String,privatekey:String,passphrase:String})},27:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>h});r(2675),r(9463),r(6412),r(2259),r(5700),r(8125),r(6280),r(6918),r(8706),r(1629),r(3792),r(4114),r(4490),r(4782),r(9572),r(4170),r(2010),r(4731),r(479),r(2892),r(9904),r(4185),r(875),r(287),r(6099),r(3362),r(825),r(7764),r(3500),r(2953);function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function a(){a=function(){return t};var e,t={},r=Object.prototype,o=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},s="function"==typeof Symbol?Symbol:{},c=s.iterator||"@@iterator",u=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function d(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(e){d=function(e,t,r){return e[t]=r}}function f(e,t,r,n){var a=t&&t.prototype instanceof b?t:b,o=Object.create(a.prototype),s=new j(n||[]);return i(o,"_invoke",{value:I(e,r,s)}),o}function p(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=f;var h="suspendedStart",m="suspendedYield",g="executing",v="completed",y={};function b(){}function w(){}function x(){}var E={};d(E,c,(function(){return this}));var L=Object.getPrototypeOf,k=L&&L(L(P([])));k&&k!==r&&o.call(k,c)&&(E=k);var M=x.prototype=b.prototype=Object.create(E);function C(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function A(e,t){function r(a,i,s,c){var u=p(e[a],e,i);if("throw"!==u.type){var l=u.arg,d=l.value;return d&&"object"==n(d)&&o.call(d,"__await")?t.resolve(d.__await).then((function(e){r("next",e,s,c)}),(function(e){r("throw",e,s,c)})):t.resolve(d).then((function(e){l.value=e,s(l)}),(function(e){return r("throw",e,s,c)}))}c(u.arg)}var a;i(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,a){r(e,n,t,a)}))}return a=a?a.then(o,o):o()}})}function I(t,r,n){var a=h;return function(o,i){if(a===g)throw Error("Generator is already running");if(a===v){if("throw"===o)throw i;return{value:e,done:!0}}for(n.method=o,n.arg=i;;){var s=n.delegate;if(s){var c=T(s,n);if(c){if(c===y)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===h)throw a=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=g;var u=p(t,r,n);if("normal"===u.type){if(a=n.done?v:m,u.arg===y)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(a=v,n.method="throw",n.arg=u.arg)}}}function T(t,r){var n=r.method,a=t.iterator[n];if(a===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,T(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var o=p(a,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,y;var i=o.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,y):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function j(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function P(t){if(t||""===t){var r=t[c];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,i=function r(){for(;++a<t.length;)if(o.call(t,a))return r.value=t[a],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(n(t)+" is not iterable")}return w.prototype=x,i(M,"constructor",{value:x,configurable:!0}),i(x,"constructor",{value:w,configurable:!0}),w.displayName=d(x,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,x):(e.__proto__=x,d(e,l,"GeneratorFunction")),e.prototype=Object.create(M),e},t.awrap=function(e){return{__await:e}},C(A.prototype),d(A.prototype,u,(function(){return this})),t.AsyncIterator=A,t.async=function(e,r,n,a,o){void 0===o&&(o=Promise);var i=new A(f(e,r,n,a),o);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},C(M),d(M,l,"Generator"),d(M,c,(function(){return this})),d(M,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=P,j.prototype={constructor:j,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(n,a){return s.type="throw",s.arg=t,r.next=n,a&&(r.method="next",r.arg=e),!!a}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],s=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var c=o.call(i,"catchLoc"),u=o.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var a=n;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,y):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;O(r)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:P(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),y}},t}function o(e,t,r,n,a,o,i){try{var s=e[o](i),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,a)}function i(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function s(e){o(i,n,a,s,c,"next",e)}function c(e){o(i,n,a,s,c,"throw",e)}s(void 0)}))}}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,p(n.key),n)}}function c(e,t,r){return t=l(t),function(e,t){if(t&&("object"==n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,u()?Reflect.construct(t,r||[],l(e).constructor):t.apply(e,r))}function u(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(u=function(){return!!e})()}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}function d(e,t){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},d(e,t)}function f(e,t,r){return(t=p(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function p(e){var t=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=n(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==n(t)?t:t+""}var h=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return f(e=c(this,t,[].concat(n)),"connect",i(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))),f(e,"showPassword",(function(e){var t=document.getElementById(e.params.inputPasswordId),r=document.getElementById(e.params.eyeSvg),n=document.getElementById(e.params.eyeSvgDefault);e.params.isShow?(r.classList.add("hidden"),n.classList.remove("hidden"),t.setAttribute("type","text")):(r.classList.remove("hidden"),n.classList.add("hidden"),t.setAttribute("type","password"))})),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(t,e),r=t,n&&s(r.prototype,n),o&&s(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(r(2891).xI)},4378:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d});r(2675),r(9463),r(2259),r(5700),r(6280),r(6918),r(8706),r(3792),r(9572),r(4170),r(2892),r(9904),r(4185),r(875),r(287),r(6099),r(825),r(7764),r(2953);function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,l(n.key),n)}}function o(e,t,r){return t=s(t),function(e,t){if(t&&("object"==n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,i()?Reflect.construct(t,r||[],s(e).constructor):t.apply(e,r))}function i(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(i=function(){return!!e})()}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}function c(e,t){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},c(e,t)}function u(e,t,r){return(t=l(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l(e){var t=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=n(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==n(t)?t:t+""}var d=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];return u(e=o(this,t,[].concat(n)),"connect",(function(){})),u(e,"showPassword",(function(e){var t=document.getElementById(e.params.inputPasswordId),r=document.getElementById(e.params.eyeSvg),n=document.getElementById(e.params.eyeSvgDefault);e.params.isShow?(r.classList.add("hidden"),n.classList.remove("hidden"),t.setAttribute("type","text")):(r.classList.remove("hidden"),n.classList.add("hidden"),t.setAttribute("type","password"))})),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(t,e),r=t,n&&a(r.prototype,n),i&&a(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(r(2891).xI)},2401:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d});r(2675),r(9463),r(2259),r(5700),r(6280),r(6918),r(8706),r(3792),r(9572),r(4170),r(2892),r(9904),r(4185),r(875),r(287),r(6099),r(825),r(7764),r(2953);function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,l(n.key),n)}}function o(e,t,r){return t=s(t),function(e,t){if(t&&("object"==n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,i()?Reflect.construct(t,r||[],s(e).constructor):t.apply(e,r))}function i(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(i=function(){return!!e})()}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}function c(e,t){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},c(e,t)}function u(e,t,r){return(t=l(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l(e){var t=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=n(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==n(t)?t:t+""}var d=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];return u(e=o(this,t,[].concat(n)),"connect",(function(){})),u(e,"showPassword",(function(e){var t=document.getElementById(e.params.inputPasswordId),r=document.getElementById(e.params.eyeSvg),n=document.getElementById(e.params.eyeSvgDefault);e.params.isShow?(r.classList.add("hidden"),n.classList.remove("hidden"),t.setAttribute("type","text")):(r.classList.remove("hidden"),n.classList.add("hidden"),t.setAttribute("type","password"))})),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(t,e),r=t,n&&a(r.prototype,n),i&&a(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(r(2891).xI)},945:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});var n=r(2891);const a=class extends n.xI{constructor(e){super(e),this.__stimulusLazyController=!0}initialize(){this.application.controllers.find((e=>e.identifier===this.identifier&&e.__stimulusLazyController))||r.e(125).then(r.bind(r,9125)).then((e=>{this.application.register(this.identifier,e.default)}))}}},2882:(e,t,r)=>{"use strict";(0,r(3066).E)(r(5926)),r(2315)},477:()=>{}},e=>{e.O(0,[835],(()=>{return t=2882,e(e.s=t);var t}));e.O()}]);